<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.11">
  <compounddef id="reduction_8h" kind="file" language="C++">
    <compoundname>reduction.h</compoundname>
    <includes refid="operation_8h" local="no">tvm/te/operation.h</includes>
    <includes refid="broadcast_8h" local="no">topi/broadcast.h</includes>
    <includes refid="elemwise_8h" local="no">topi/elemwise.h</includes>
    <includes refid="tags_8h" local="no">topi/tags.h</includes>
    <includes refid="topi_2include_2topi_2transform_8h" local="no">topi/transform.h</includes>
    <includes refid="ravel__unravel_8h" local="no">topi/detail/ravel_unravel.h</includes>
    <includes refid="constant__utils_8h" local="no">topi/detail/constant_utils.h</includes>
    <includes local="no">algorithm</includes>
    <includes local="no">string</includes>
    <includes local="no">vector</includes>
    <includes local="no">iterator</includes>
    <includedby refid="nn_2pooling_8h" local="no">topi/include/topi/nn/pooling.h</includedby>
    <includedby refid="nn_2softmax_8h" local="no">topi/include/topi/nn/softmax.h</includedby>
    <includedby refid="reorg_8h" local="no">topi/include/topi/vision/reorg.h</includedby>
    <incdepgraph>
      <node id="17522">
        <label>tvm/arith/int_set.h</label>
        <link refid="int__set_8h"/>
        <childnode refid="17486" relation="include">
        </childnode>
        <childnode refid="17523" relation="include">
        </childnode>
        <childnode refid="17504" relation="include">
        </childnode>
      </node>
      <node id="17519">
        <label>tvm/ir/span.h</label>
        <link refid="span_8h"/>
        <childnode refid="17487" relation="include">
        </childnode>
        <childnode refid="17495" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
      </node>
      <node id="17494">
        <label>atomic</label>
      </node>
      <node id="17530">
        <label>tvm/tir/buffer.h</label>
        <link refid="buffer_8h"/>
        <childnode refid="17514" relation="include">
        </childnode>
        <childnode refid="17523" relation="include">
        </childnode>
        <childnode refid="17527" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
      </node>
      <node id="17524">
        <label>tvm/te/tensor.h</label>
        <link refid="tensor_8h"/>
        <childnode refid="17514" relation="include">
        </childnode>
        <childnode refid="17525" relation="include">
        </childnode>
        <childnode refid="17523" relation="include">
        </childnode>
        <childnode refid="17527" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
        <childnode refid="17503" relation="include">
        </childnode>
        <childnode refid="17485" relation="include">
        </childnode>
        <childnode refid="17492" relation="include">
        </childnode>
      </node>
      <node id="17509">
        <label>functional</label>
      </node>
      <node id="17548">
        <label>topi/detail/tensor_utils.h</label>
        <link refid="tensor__utils_8h"/>
        <childnode refid="17481" relation="include">
        </childnode>
      </node>
      <node id="17511">
        <label>limits</label>
      </node>
      <node id="17536">
        <label>tvm/ir/function.h</label>
        <link refid="ir_2function_8h"/>
        <childnode refid="17486" relation="include">
        </childnode>
        <childnode refid="17537" relation="include">
        </childnode>
        <childnode refid="17492" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
      </node>
      <node id="17500">
        <label>tvm/runtime/module.h</label>
        <link refid="runtime_2module_8h"/>
        <childnode refid="17501" relation="include">
        </childnode>
        <childnode refid="17488" relation="include">
        </childnode>
        <childnode refid="17487" relation="include">
        </childnode>
        <childnode refid="17496" relation="include">
        </childnode>
        <childnode refid="17502" relation="include">
        </childnode>
        <childnode refid="17503" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
        <childnode refid="17504" relation="include">
        </childnode>
        <childnode refid="17499" relation="include">
        </childnode>
      </node>
      <node id="17499">
        <label>tvm/runtime/packed_func.h</label>
        <link refid="packed__func_8h"/>
        <childnode refid="17484" relation="include">
        </childnode>
        <childnode refid="17488" relation="include">
        </childnode>
        <childnode refid="17500" relation="include">
        </childnode>
        <childnode refid="17505" relation="include">
        </childnode>
        <childnode refid="17508" relation="include">
        </childnode>
        <childnode refid="17487" relation="include">
        </childnode>
        <childnode refid="17509" relation="include">
        </childnode>
        <childnode refid="17510" relation="include">
        </childnode>
        <childnode refid="17503" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
        <childnode refid="17511" relation="include">
        </childnode>
        <childnode refid="17502" relation="include">
        </childnode>
        <childnode refid="17485" relation="include">
        </childnode>
        <childnode refid="17492" relation="include">
        </childnode>
      </node>
      <node id="17549">
        <label>iterator</label>
      </node>
      <node id="17513">
        <label>tvm/node/functor.h</label>
        <link refid="functor_8h"/>
        <childnode refid="17484" relation="include">
        </childnode>
        <childnode refid="17487" relation="include">
        </childnode>
        <childnode refid="17503" relation="include">
        </childnode>
        <childnode refid="17492" relation="include">
        </childnode>
        <childnode refid="17485" relation="include">
        </childnode>
      </node>
      <node id="17535">
        <label>tvm/tir/function.h</label>
        <link refid="tir_2function_8h"/>
        <childnode refid="17536" relation="include">
        </childnode>
        <childnode refid="17523" relation="include">
        </childnode>
        <childnode refid="17530" relation="include">
        </childnode>
        <childnode refid="17526" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
      </node>
      <node id="17529">
        <label>tvm/te/tensor_intrin.h</label>
        <link refid="tensor__intrin_8h"/>
        <childnode refid="17524" relation="include">
        </childnode>
        <childnode refid="17530" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
      </node>
      <node id="17487">
        <label>tvm/runtime/object.h</label>
        <link refid="object_8h"/>
        <childnode refid="17484" relation="include">
        </childnode>
        <childnode refid="17488" relation="include">
        </childnode>
        <childnode refid="17492" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
        <childnode refid="17485" relation="include">
        </childnode>
        <childnode refid="17494" relation="include">
        </childnode>
      </node>
      <node id="17490">
        <label>stdint.h</label>
      </node>
      <node id="17505">
        <label>tvm/runtime/ndarray.h</label>
        <link refid="ndarray_8h"/>
        <childnode refid="17488" relation="include">
        </childnode>
        <childnode refid="17487" relation="include">
        </childnode>
        <childnode refid="17506" relation="include">
        </childnode>
        <childnode refid="17494" relation="include">
        </childnode>
        <childnode refid="17503" relation="include">
        </childnode>
        <childnode refid="17485" relation="include">
        </childnode>
      </node>
      <node id="17516">
        <label>tvm/node/structural_hash.h</label>
        <link refid="structural__hash_8h"/>
        <childnode refid="17508" relation="include">
        </childnode>
        <childnode refid="17513" relation="include">
        </childnode>
        <childnode refid="17514" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
        <childnode refid="17509" relation="include">
        </childnode>
      </node>
      <node id="17533">
        <label>topi/detail/constant_utils.h</label>
        <link refid="constant__utils_8h"/>
        <childnode refid="17523" relation="include">
        </childnode>
        <childnode refid="17534" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
        <childnode refid="17503" relation="include">
        </childnode>
      </node>
      <node id="17482">
        <label>tvm/arith/analyzer.h</label>
        <link refid="analyzer_8h"/>
        <childnode refid="17483" relation="include">
        </childnode>
        <childnode refid="17486" relation="include">
        </childnode>
        <childnode refid="17522" relation="include">
        </childnode>
        <childnode refid="17503" relation="include">
        </childnode>
        <childnode refid="17504" relation="include">
        </childnode>
        <childnode refid="17502" relation="include">
        </childnode>
        <childnode refid="17511" relation="include">
        </childnode>
      </node>
      <node id="17544">
        <label>topi/transform.h</label>
        <link refid="topi_2include_2topi_2transform_8h"/>
        <childnode refid="17545" relation="include">
        </childnode>
        <childnode refid="17481" relation="include">
        </childnode>
        <childnode refid="17542" relation="include">
        </childnode>
        <childnode refid="17547" relation="include">
        </childnode>
        <childnode refid="17533" relation="include">
        </childnode>
        <childnode refid="17548" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
        <childnode refid="17503" relation="include">
        </childnode>
        <childnode refid="17549" relation="include">
        </childnode>
        <childnode refid="17521" relation="include">
        </childnode>
        <childnode refid="17511" relation="include">
        </childnode>
        <childnode refid="17540" relation="include">
        </childnode>
      </node>
      <node id="17523">
        <label>tvm/tir/expr.h</label>
        <link refid="tir_2expr_8h"/>
        <childnode refid="17495" relation="include">
        </childnode>
        <childnode refid="17514" relation="include">
        </childnode>
        <childnode refid="17513" relation="include">
        </childnode>
        <childnode refid="17488" relation="include">
        </childnode>
        <childnode refid="17508" relation="include">
        </childnode>
        <childnode refid="17486" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
        <childnode refid="17521" relation="include">
        </childnode>
        <childnode refid="17504" relation="include">
        </childnode>
        <childnode refid="17518" relation="include">
        </childnode>
        <childnode refid="17511" relation="include">
        </childnode>
        <childnode refid="17485" relation="include">
        </childnode>
      </node>
      <node id="17493">
        <label>string</label>
      </node>
      <node id="17538">
        <label>dmlc/common.h</label>
      </node>
      <node id="17517">
        <label>tvm/node/repr_printer.h</label>
        <link refid="repr__printer_8h"/>
        <childnode refid="17513" relation="include">
        </childnode>
        <childnode refid="17518" relation="include">
        </childnode>
      </node>
      <node id="17514">
        <label>tvm/node/container.h</label>
        <link refid="node_2container_8h"/>
        <childnode refid="17487" relation="include">
        </childnode>
        <childnode refid="17496" relation="include">
        </childnode>
        <childnode refid="17499" relation="include">
        </childnode>
        <childnode refid="17492" relation="include">
        </childnode>
        <childnode refid="17503" relation="include">
        </childnode>
        <childnode refid="17515" relation="include">
        </childnode>
        <childnode refid="17504" relation="include">
        </childnode>
        <childnode refid="17485" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
      </node>
      <node id="17540">
        <label>unordered_set</label>
      </node>
      <node id="17480">
        <label>topi/include/topi/reduction.h</label>
        <link refid="reduction.h"/>
        <childnode refid="17481" relation="include">
        </childnode>
        <childnode refid="17531" relation="include">
        </childnode>
        <childnode refid="17543" relation="include">
        </childnode>
        <childnode refid="17542" relation="include">
        </childnode>
        <childnode refid="17544" relation="include">
        </childnode>
        <childnode refid="17547" relation="include">
        </childnode>
        <childnode refid="17533" relation="include">
        </childnode>
        <childnode refid="17521" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
        <childnode refid="17503" relation="include">
        </childnode>
        <childnode refid="17549" relation="include">
        </childnode>
      </node>
      <node id="17481">
        <label>tvm/te/operation.h</label>
        <link refid="operation_8h"/>
        <childnode refid="17482" relation="include">
        </childnode>
        <childnode refid="17524" relation="include">
        </childnode>
        <childnode refid="17528" relation="include">
        </childnode>
        <childnode refid="17523" relation="include">
        </childnode>
        <childnode refid="17527" relation="include">
        </childnode>
        <childnode refid="17530" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
        <childnode refid="17503" relation="include">
        </childnode>
        <childnode refid="17504" relation="include">
        </childnode>
      </node>
      <node id="17491">
        <label>stddef.h</label>
      </node>
      <node id="17537">
        <label>tvm/ir/attrs.h</label>
        <link refid="ir_2attrs_8h"/>
        <childnode refid="17538" relation="include">
        </childnode>
        <childnode refid="17486" relation="include">
        </childnode>
        <childnode refid="17499" relation="include">
        </childnode>
        <childnode refid="17504" relation="include">
        </childnode>
        <childnode refid="17503" relation="include">
        </childnode>
        <childnode refid="17509" relation="include">
        </childnode>
        <childnode refid="17492" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
        <childnode refid="17485" relation="include">
        </childnode>
      </node>
      <node id="17525">
        <label>tvm/arith/bound.h</label>
        <link refid="bound_8h"/>
        <childnode refid="17514" relation="include">
        </childnode>
        <childnode refid="17486" relation="include">
        </childnode>
        <childnode refid="17522" relation="include">
        </childnode>
        <childnode refid="17523" relation="include">
        </childnode>
        <childnode refid="17526" relation="include">
        </childnode>
        <childnode refid="17504" relation="include">
        </childnode>
      </node>
      <node id="17539">
        <label>tvm/tir/lowered_func.h</label>
        <link refid="lowered__func_8h"/>
        <childnode refid="17514" relation="include">
        </childnode>
        <childnode refid="17523" relation="include">
        </childnode>
        <childnode refid="17526" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
      </node>
      <node id="17527">
        <label>tvm/tir/op.h</label>
        <link refid="tir_2op_8h"/>
        <childnode refid="17520" relation="include">
        </childnode>
        <childnode refid="17523" relation="include">
        </childnode>
        <childnode refid="17526" relation="include">
        </childnode>
        <childnode refid="17521" relation="include">
        </childnode>
        <childnode refid="17492" relation="include">
        </childnode>
        <childnode refid="17511" relation="include">
        </childnode>
      </node>
      <node id="17486">
        <label>tvm/ir/expr.h</label>
        <link refid="ir_2expr_8h"/>
        <childnode refid="17487" relation="include">
        </childnode>
        <childnode refid="17495" relation="include">
        </childnode>
        <childnode refid="17514" relation="include">
        </childnode>
        <childnode refid="17519" relation="include">
        </childnode>
        <childnode refid="17520" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
        <childnode refid="17521" relation="include">
        </childnode>
        <childnode refid="17511" relation="include">
        </childnode>
        <childnode refid="17492" relation="include">
        </childnode>
      </node>
      <node id="17532">
        <label>topi/detail/broadcast.h</label>
        <link refid="detail_2broadcast_8h"/>
        <childnode refid="17481" relation="include">
        </childnode>
        <childnode refid="17533" relation="include">
        </childnode>
        <childnode refid="17521" relation="include">
        </childnode>
        <childnode refid="17541" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
      </node>
      <node id="17510">
        <label>tuple</label>
      </node>
      <node id="17484">
        <label>dmlc/logging.h</label>
      </node>
      <node id="17526">
        <label>tvm/tir/stmt.h</label>
        <link refid="stmt_8h"/>
        <childnode refid="17523" relation="include">
        </childnode>
        <childnode refid="17492" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
        <childnode refid="17503" relation="include">
        </childnode>
        <childnode refid="17485" relation="include">
        </childnode>
      </node>
      <node id="17503">
        <label>vector</label>
      </node>
      <node id="17512">
        <label>tvm/node/structural_equal.h</label>
        <link refid="structural__equal_8h"/>
        <childnode refid="17508" relation="include">
        </childnode>
        <childnode refid="17513" relation="include">
        </childnode>
        <childnode refid="17514" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
      </node>
      <node id="17501">
        <label>dmlc/io.h</label>
      </node>
      <node id="17488">
        <label>tvm/runtime/c_runtime_api.h</label>
        <link refid="c__runtime__api_8h"/>
        <childnode refid="17489" relation="include">
        </childnode>
        <childnode refid="17490" relation="include">
        </childnode>
        <childnode refid="17491" relation="include">
        </childnode>
      </node>
      <node id="17520">
        <label>tvm/ir/type.h</label>
        <link refid="ir_2type_8h"/>
        <childnode refid="17487" relation="include">
        </childnode>
        <childnode refid="17508" relation="include">
        </childnode>
        <childnode refid="17495" relation="include">
        </childnode>
        <childnode refid="17514" relation="include">
        </childnode>
        <childnode refid="17519" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
      </node>
      <node id="17534">
        <label>tvm/tir/ir_pass.h</label>
        <link refid="ir__pass_8h"/>
        <childnode refid="17528" relation="include">
        </childnode>
        <childnode refid="17523" relation="include">
        </childnode>
        <childnode refid="17530" relation="include">
        </childnode>
        <childnode refid="17535" relation="include">
        </childnode>
        <childnode refid="17539" relation="include">
        </childnode>
        <childnode refid="17504" relation="include">
        </childnode>
        <childnode refid="17540" relation="include">
        </childnode>
        <childnode refid="17503" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
      </node>
      <node id="17485">
        <label>utility</label>
      </node>
      <node id="17546">
        <label>sstream</label>
      </node>
      <node id="17495">
        <label>tvm/node/node.h</label>
        <link refid="node_8h"/>
        <childnode refid="17488" relation="include">
        </childnode>
        <childnode refid="17487" relation="include">
        </childnode>
        <childnode refid="17496" relation="include">
        </childnode>
        <childnode refid="17498" relation="include">
        </childnode>
        <childnode refid="17517" relation="include">
        </childnode>
        <childnode refid="17514" relation="include">
        </childnode>
        <childnode refid="17512" relation="include">
        </childnode>
        <childnode refid="17516" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
        <childnode refid="17503" relation="include">
        </childnode>
        <childnode refid="17485" relation="include">
        </childnode>
        <childnode refid="17492" relation="include">
        </childnode>
      </node>
      <node id="17531">
        <label>topi/broadcast.h</label>
        <link refid="broadcast_8h"/>
        <childnode refid="17532" relation="include">
        </childnode>
        <childnode refid="17533" relation="include">
        </childnode>
        <childnode refid="17542" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
        <childnode refid="17521" relation="include">
        </childnode>
      </node>
      <node id="17507">
        <label>dmlc/serializer.h</label>
      </node>
      <node id="17497">
        <label>cstdlib</label>
      </node>
      <node id="17547">
        <label>topi/detail/ravel_unravel.h</label>
        <link refid="ravel__unravel_8h"/>
        <childnode refid="17481" relation="include">
        </childnode>
        <childnode refid="17503" relation="include">
        </childnode>
      </node>
      <node id="17518">
        <label>iostream</label>
      </node>
      <node id="17506">
        <label>tvm/runtime/serializer.h</label>
        <link refid="serializer_8h"/>
        <childnode refid="17501" relation="include">
        </childnode>
        <childnode refid="17507" relation="include">
        </childnode>
        <childnode refid="17488" relation="include">
        </childnode>
        <childnode refid="17505" relation="include">
        </childnode>
      </node>
      <node id="17541">
        <label>deque</label>
      </node>
      <node id="17504">
        <label>unordered_map</label>
      </node>
      <node id="17498">
        <label>tvm/node/reflection.h</label>
        <link refid="reflection_8h"/>
        <childnode refid="17488" relation="include">
        </childnode>
        <childnode refid="17487" relation="include">
        </childnode>
        <childnode refid="17496" relation="include">
        </childnode>
        <childnode refid="17499" relation="include">
        </childnode>
        <childnode refid="17505" relation="include">
        </childnode>
        <childnode refid="17508" relation="include">
        </childnode>
        <childnode refid="17512" relation="include">
        </childnode>
        <childnode refid="17516" relation="include">
        </childnode>
        <childnode refid="17503" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
        <childnode refid="17492" relation="include">
        </childnode>
      </node>
      <node id="17496">
        <label>tvm/runtime/memory.h</label>
        <link refid="runtime_2memory_8h"/>
        <childnode refid="17487" relation="include">
        </childnode>
        <childnode refid="17497" relation="include">
        </childnode>
        <childnode refid="17485" relation="include">
        </childnode>
        <childnode refid="17492" relation="include">
        </childnode>
      </node>
      <node id="17508">
        <label>tvm/runtime/data_type.h</label>
        <link refid="data__type_8h"/>
        <childnode refid="17488" relation="include">
        </childnode>
        <childnode refid="17484" relation="include">
        </childnode>
        <childnode refid="17492" relation="include">
        </childnode>
      </node>
      <node id="17483">
        <label>tvm/support/with.h</label>
        <link refid="with_8h"/>
        <childnode refid="17484" relation="include">
        </childnode>
        <childnode refid="17485" relation="include">
        </childnode>
      </node>
      <node id="17492">
        <label>type_traits</label>
      </node>
      <node id="17521">
        <label>algorithm</label>
      </node>
      <node id="17542">
        <label>topi/tags.h</label>
        <link refid="tags_8h"/>
        <childnode refid="17493" relation="include">
        </childnode>
      </node>
      <node id="17489">
        <label>dlpack/dlpack.h</label>
      </node>
      <node id="17528">
        <label>tvm/te/schedule.h</label>
        <link refid="schedule_8h"/>
        <childnode refid="17523" relation="include">
        </childnode>
        <childnode refid="17524" relation="include">
        </childnode>
        <childnode refid="17529" relation="include">
        </childnode>
        <childnode refid="17483" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
        <childnode refid="17504" relation="include">
        </childnode>
      </node>
      <node id="17543">
        <label>topi/elemwise.h</label>
        <link refid="elemwise_8h"/>
        <childnode refid="17523" relation="include">
        </childnode>
        <childnode refid="17534" relation="include">
        </childnode>
        <childnode refid="17542" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
        <childnode refid="17531" relation="include">
        </childnode>
      </node>
      <node id="17502">
        <label>memory</label>
      </node>
      <node id="17515">
        <label>initializer_list</label>
      </node>
      <node id="17545">
        <label>tvm/tir/data_layout.h</label>
        <link refid="data__layout_8h"/>
        <childnode refid="17523" relation="include">
        </childnode>
        <childnode refid="17527" relation="include">
        </childnode>
        <childnode refid="17493" relation="include">
        </childnode>
        <childnode refid="17546" relation="include">
        </childnode>
        <childnode refid="17503" relation="include">
        </childnode>
        <childnode refid="17485" relation="include">
        </childnode>
        <childnode refid="17521" relation="include">
        </childnode>
      </node>
    </incdepgraph>
    <invincdepgraph>
      <node id="17553">
        <label>topi/include/topi/vision/reorg.h</label>
        <link refid="reorg_8h"/>
      </node>
      <node id="17552">
        <label>topi/include/topi/nn/softmax.h</label>
        <link refid="nn_2softmax_8h"/>
      </node>
      <node id="17550">
        <label>topi/include/topi/reduction.h</label>
        <link refid="reduction.h"/>
        <childnode refid="17551" relation="include">
        </childnode>
        <childnode refid="17552" relation="include">
        </childnode>
        <childnode refid="17553" relation="include">
        </childnode>
      </node>
      <node id="17551">
        <label>topi/include/topi/nn/pooling.h</label>
        <link refid="nn_2pooling_8h"/>
      </node>
    </invincdepgraph>
    <innernamespace refid="namespacetopi">topi</innernamespace>
    <briefdescription>
<para>Reduction op constructors. </para>    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>Licensed<sp/>to<sp/>the<sp/>Apache<sp/>Software<sp/>Foundation<sp/>(ASF)<sp/>under<sp/>one</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*<sp/>or<sp/>more<sp/>contributor<sp/>license<sp/>agreements.<sp/><sp/>See<sp/>the<sp/>NOTICE<sp/>file</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/>distributed<sp/>with<sp/>this<sp/>work<sp/>for<sp/>additional<sp/>information</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*<sp/>regarding<sp/>copyright<sp/>ownership.<sp/><sp/>The<sp/>ASF<sp/>licenses<sp/>this<sp/>file</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*<sp/>to<sp/>you<sp/>under<sp/>the<sp/>Apache<sp/>License,<sp/>Version<sp/>2.0<sp/>(the</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*<sp/>&quot;License&quot;);<sp/>you<sp/>may<sp/>not<sp/>use<sp/>this<sp/>file<sp/>except<sp/>in<sp/>compliance</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*<sp/>with<sp/>the<sp/>License.<sp/><sp/>You<sp/>may<sp/>obtain<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>License<sp/>at</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*<sp/><sp/><sp/>http://www.apache.org/licenses/LICENSE-2.0</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*<sp/>Unless<sp/>required<sp/>by<sp/>applicable<sp/>law<sp/>or<sp/>agreed<sp/>to<sp/>in<sp/>writing,</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*<sp/>software<sp/>distributed<sp/>under<sp/>the<sp/>License<sp/>is<sp/>distributed<sp/>on<sp/>an</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*<sp/>&quot;AS<sp/>IS&quot;<sp/>BASIS,<sp/>WITHOUT<sp/>WARRANTIES<sp/>OR<sp/>CONDITIONS<sp/>OF<sp/>ANY</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>*<sp/>KIND,<sp/>either<sp/>express<sp/>or<sp/>implied.<sp/><sp/>See<sp/>the<sp/>License<sp/>for<sp/>the</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>*<sp/>specific<sp/>language<sp/>governing<sp/>permissions<sp/>and<sp/>limitations</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*<sp/>under<sp/>the<sp/>License.</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="preprocessor">#ifndef<sp/>TOPI_REDUCTION_H_</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>TOPI_REDUCTION_H_</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="operation_8h" kindref="compound">tvm/te/operation.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="broadcast_8h" kindref="compound">topi/broadcast.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="elemwise_8h" kindref="compound">topi/elemwise.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="tags_8h" kindref="compound">topi/tags.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="topi_2include_2topi_2transform_8h" kindref="compound">topi/transform.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="ravel__unravel_8h" kindref="compound">topi/detail/ravel_unravel.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="constant__utils_8h" kindref="compound">topi/detail/constant_utils.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;algorithm&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;string&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;vector&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;iterator&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal"><ref refid="namespacetopi" kindref="compound">topi</ref><sp/>{</highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="keyword">using<sp/>namespace<sp/></highlight><highlight class="normal"><ref refid="namespacetvm" kindref="compound">tvm</ref>;</highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight><highlight class="keyword">using<sp/>namespace<sp/></highlight><highlight class="normal"><ref refid="namespacetvm_1_1te" kindref="compound">tvm::te</ref>;</highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight></codeline>
<codeline lineno="45" refid="namespacetopi_1a4d0f5ddce836d926393ac3d154170ef6" refkind="member"><highlight class="keyword">using</highlight><highlight class="normal"><sp/><ref refid="namespacetopi_1a4d0f5ddce836d926393ac3d154170ef6" kindref="member">FReduce</ref><sp/>=<sp/>std::function&lt;PrimExpr(PrimExpr<sp/>source,<sp/>const<sp/>Array&lt;IterVar&gt;&amp;<sp/>axis)&gt;;</highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="keyword">using</highlight><highlight class="normal"><sp/><ref refid="namespacetopi_1a8baac534d5ff12a20f089736a0e60f14" kindref="member">FCommReduce</ref><sp/>=<sp/>std::function&lt;</highlight></codeline>
<codeline lineno="49" refid="namespacetopi_1a8baac534d5ff12a20f089736a0e60f14" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;PrimExpr&gt;</ref>(<ref refid="classtvm_1_1Array" kindref="compound">Array&lt;PrimExpr&gt;</ref><sp/>exprs,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;IterVar&gt;</ref>&amp;<sp/>axis,<sp/><ref refid="classtvm_1_1PrimExpr" kindref="compound">PrimExpr</ref>*<sp/>condition)&gt;;</highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight></codeline>
<codeline lineno="63" refid="namespacetopi_1a2c7364c2934ba1b64d9d9a5837e77497" refkind="member"><highlight class="keyword">inline</highlight><highlight class="normal"><sp/>std::vector&lt;int&gt;<sp/><ref refid="namespacetopi_1a2c7364c2934ba1b64d9d9a5837e77497" kindref="member">GetRealAxis</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ndim,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;Integer&gt;</ref>&amp;<sp/>axis)<sp/>{</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/>std::vector&lt;int&gt;<sp/>real_axis;</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!axis.defined()<sp/>||<sp/>axis.<ref refid="classtvm_1_1Array_1a6c150ee7d3e46117b099d2052b19aec5" kindref="member">size</ref>()<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>ndim;<sp/>++i)<sp/>{</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>real_axis.push_back(i);</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Use<sp/>a<sp/>set<sp/>so<sp/>duplicates<sp/>are<sp/>removed<sp/>and<sp/>the<sp/>dims<sp/>are<sp/>sorted</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>elem<sp/>:<sp/>axis)<sp/>{</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>int64_t<sp/>val<sp/>=<sp/>elem-&gt;value;</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(val<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>val<sp/>+=<sp/>ndim;</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CHECK_LE(val,<sp/>ndim)<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>exceeds<sp/>the<sp/>maximum<sp/>dimension<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>ndim;</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CHECK_GE(val,<sp/>0);</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>real_axis.push_back(static_cast&lt;int&gt;(val));</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/>std::sort(real_axis.begin(),<sp/>real_axis.end());</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/>real_axis.resize(</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>std::unique(real_axis.begin(),<sp/>real_axis.end())<sp/>-<sp/>real_axis.begin());</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>real_axis;</highlight></codeline>
<codeline lineno="85"><highlight class="normal">}</highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight></codeline>
<codeline lineno="88" refid="namespacetopi_1aa9ac5704585fb8f3592081e0833c9163" refkind="member"><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;IterVar&gt;</ref><sp/><ref refid="namespacetopi_1aa9ac5704585fb8f3592081e0833c9163" kindref="member">MakeReduceAxes</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>std::vector&lt;int&gt;&amp;<sp/>real_axis,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1te_1_1Tensor" kindref="compound">Tensor</ref>&amp;<sp/>data)<sp/>{</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;IterVar&gt;</ref><sp/>reduce_axes;</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>i<sp/>:<sp/>real_axis)<sp/>{</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/>std::string<sp/>name<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;k&quot;</highlight><highlight class="normal"><sp/>+<sp/>std::to_string(i);</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/>reduce_axes.<ref refid="classtvm_1_1Array_1a24d5ac1f6730d46cb1a6d16729f0a7bb" kindref="member">push_back</ref>(</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacetvm_1_1te_1aae384e9b73c2271905486e4a74b69265" kindref="member">tvm::te::reduce_axis</ref>(<ref refid="classtvm_1_1Range" kindref="compound">Range</ref>(0,<sp/>data-&gt;<ref refid="classtvm_1_1te_1_1TensorNode_1a0ba732bc2def0d467854585752911351" kindref="member">shape</ref>[i]),<sp/>name));</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>reduce_axes;</highlight></codeline>
<codeline lineno="96"><highlight class="normal">}</highlight></codeline>
<codeline lineno="97"><highlight class="normal"></highlight></codeline>
<codeline lineno="99" refid="namespacetopi_1ab69e23e61282f3e99cacf20b55c57d13" refkind="member"><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;PrimExpr&gt;</ref><sp/><ref refid="namespacetopi_1ab69e23e61282f3e99cacf20b55c57d13" kindref="member">MakeReduceTargetShape</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>std::vector&lt;int&gt;&amp;<sp/>real_axis,</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1te_1_1Tensor" kindref="compound">Tensor</ref>&amp;<sp/>data,</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>keepdims,</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>atleast1d)<sp/>{</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>ndim<sp/>=<sp/>data-&gt;<ref refid="classtvm_1_1te_1_1TensorNode_1a0ba732bc2def0d467854585752911351" kindref="member">shape</ref>.size();</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;PrimExpr&gt;</ref><sp/>target_shape;</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(keepdims)<sp/>{</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>ndim;<sp/>++i)<sp/>{</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(std::find(real_axis.begin(),<sp/>real_axis.end(),<sp/>i)<sp/>!=<sp/>real_axis.end())<sp/>{</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>real_axis<sp/>contains<sp/>i</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target_shape.<ref refid="classtvm_1_1Array_1a24d5ac1f6730d46cb1a6d16729f0a7bb" kindref="member">push_back</ref>(1);</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target_shape.<ref refid="classtvm_1_1Array_1a24d5ac1f6730d46cb1a6d16729f0a7bb" kindref="member">push_back</ref>(data-&gt;<ref refid="classtvm_1_1te_1_1TensorNode_1a0ba732bc2def0d467854585752911351" kindref="member">shape</ref>[i]);</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>ndim;<sp/>++i)<sp/>{</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(std::find(real_axis.begin(),<sp/>real_axis.end(),<sp/>i)<sp/>==<sp/>real_axis.end())<sp/>{</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>real_axis<sp/>does<sp/>not<sp/>contain<sp/>i</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target_shape.<ref refid="classtvm_1_1Array_1a24d5ac1f6730d46cb1a6d16729f0a7bb" kindref="member">push_back</ref>(data-&gt;<ref refid="classtvm_1_1te_1_1TensorNode_1a0ba732bc2def0d467854585752911351" kindref="member">shape</ref>[i]);</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(target_shape.<ref refid="classtvm_1_1Array_1a6c150ee7d3e46117b099d2052b19aec5" kindref="member">size</ref>()<sp/>==<sp/>0<sp/>&amp;&amp;<sp/>atleast1d)<sp/>{</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/>target_shape.<ref refid="classtvm_1_1Array_1a24d5ac1f6730d46cb1a6d16729f0a7bb" kindref="member">push_back</ref>(1);</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>target_shape;</highlight></codeline>
<codeline lineno="126"><highlight class="normal">}</highlight></codeline>
<codeline lineno="127"><highlight class="normal"></highlight></codeline>
<codeline lineno="140" refid="namespacetopi_1ab5ae1df78350ee84b7dc49922523365d" refkind="member"><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1te_1_1Tensor" kindref="compound">Tensor</ref><sp/><ref refid="namespacetopi_1ab5ae1df78350ee84b7dc49922523365d" kindref="member">DoCommReduce</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1te_1_1Tensor" kindref="compound">Tensor</ref>&amp;<sp/>data,</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacetopi_1a4d0f5ddce836d926393ac3d154170ef6" kindref="member">FReduce</ref><sp/>func,</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;PrimExpr&gt;</ref>&amp;<sp/>target_shape,</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>std::vector&lt;int&gt;&amp;<sp/>reduce_axes,</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>std::vector&lt;int&gt;&amp;<sp/>squeeze_axes)<sp/>{</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>r_axes<sp/>=<sp/><ref refid="namespacetopi_1aa9ac5704585fb8f3592081e0833c9163" kindref="member">MakeReduceAxes</ref>(reduce_axes,<sp/>data);</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/><ref refid="namespacetvm_1_1te_1aeacae1afc9dd1267cbb5779f9daa4671" kindref="member">compute</ref><sp/>=<sp/>[&amp;](</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;Var&gt;</ref>&amp;<sp/>indices)<sp/>{</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;PrimExpr&gt;</ref><sp/>eval_range;</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;Var&gt;</ref><sp/>eval_indices;</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>arg_counter<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>red_counter<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="151"><highlight class="normal"></highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>data-&gt;<ref refid="classtvm_1_1te_1_1TensorNode_1a0ba732bc2def0d467854585752911351" kindref="member">shape</ref>.size();<sp/>++i)<sp/>{</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>squeeze_i<sp/>=<sp/>std::find(squeeze_axes.begin(),<sp/>squeeze_axes.end(),<sp/>i)<sp/>!=<sp/>squeeze_axes.<ref refid="classtvm_1_1Array_1a6f05e6a14eca3ea865da0f293b4a5325" kindref="member">end</ref>();</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(std::find(reduce_axes.begin(),<sp/>reduce_axes.end(),<sp/>i)<sp/>!=<sp/>reduce_axes.end())<sp/>{</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>real_axis<sp/>contains<sp/>i</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eval_range.<ref refid="classtvm_1_1Array_1a24d5ac1f6730d46cb1a6d16729f0a7bb" kindref="member">push_back</ref>(r_axes[red_counter]);</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eval_indices.<ref refid="classtvm_1_1Array_1a24d5ac1f6730d46cb1a6d16729f0a7bb" kindref="member">push_back</ref>(r_axes[red_counter]-&gt;<ref refid="namespacetvm_1_1te_1ae0c71f84710b436cbe0b32289d0838f4" kindref="member">var</ref>);</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>red_counter++;</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>arg_counter<sp/>+=<sp/>!squeeze_i;</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>eval_range.<ref refid="classtvm_1_1Array_1a24d5ac1f6730d46cb1a6d16729f0a7bb" kindref="member">push_back</ref>(indices[arg_counter]);</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>arg_counter++;</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="165"><highlight class="normal"></highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>func(data(eval_range),<sp/>r_axes);</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/>};</highlight></codeline>
<codeline lineno="168"><highlight class="normal"></highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="namespacetvm_1_1te_1aeacae1afc9dd1267cbb5779f9daa4671" kindref="member">tvm::te::compute</ref>(target_shape,<sp/><ref refid="namespacetvm_1_1te_1aeacae1afc9dd1267cbb5779f9daa4671" kindref="member">compute</ref>,<sp/>data-&gt;<ref refid="classtvm_1_1te_1_1TensorNode_1a64faab73896ac7e9dd8dc43110920c7c" kindref="member">op</ref>-&gt;<ref refid="classtvm_1_1te_1_1OperationNode_1ad2fd6f140257f7b3c311f88374fa74d2" kindref="member">name</ref><sp/>+<sp/></highlight><highlight class="stringliteral">&quot;_red&quot;</highlight><highlight class="normal">,<sp/><ref refid="namespacetopi_1ae57dced7232a8ef1f94cd669c72e0093" kindref="member">kCommReduce</ref>);</highlight></codeline>
<codeline lineno="170"><highlight class="normal">}</highlight></codeline>
<codeline lineno="171"><highlight class="normal"></highlight></codeline>
<codeline lineno="185" refid="namespacetopi_1a173c99250d923eff68fc63925b575497" refkind="member"><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1te_1_1Tensor" kindref="compound">Tensor</ref><sp/><ref refid="namespacetopi_1a173c99250d923eff68fc63925b575497" kindref="member">CommReduce</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1te_1_1Tensor" kindref="compound">Tensor</ref>&amp;<sp/>data,</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;Integer&gt;</ref>&amp;<sp/>axis,</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacetopi_1a4d0f5ddce836d926393ac3d154170ef6" kindref="member">FReduce</ref><sp/>func,</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>keepdims,</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>atleast1d)<sp/>{</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>ndim<sp/>=<sp/>data-&gt;<ref refid="classtvm_1_1te_1_1TensorNode_1a0ba732bc2def0d467854585752911351" kindref="member">shape</ref>.size();</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/>CHECK_NE(ndim,<sp/>0)<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;Cannot<sp/>reduce<sp/>a<sp/>0<sp/>dim<sp/>Tensor&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>real_axis<sp/>=<sp/><ref refid="namespacetopi_1a2c7364c2934ba1b64d9d9a5837e77497" kindref="member">GetRealAxis</ref>(static_cast&lt;int&gt;(ndim),<sp/>axis);</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>target_shape<sp/>=<sp/><ref refid="namespacetopi_1ab69e23e61282f3e99cacf20b55c57d13" kindref="member">MakeReduceTargetShape</ref>(real_axis,<sp/>data,<sp/>keepdims,<sp/>atleast1d);</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="namespacetopi_1ab5ae1df78350ee84b7dc49922523365d" kindref="member">DoCommReduce</ref>(data,<sp/>func,<sp/>target_shape,<sp/>real_axis,</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>keepdims<sp/>?<sp/>std::vector&lt;int&gt;()<sp/>:<sp/>real_axis);</highlight></codeline>
<codeline lineno="196"><highlight class="normal">}</highlight></codeline>
<codeline lineno="197"><highlight class="normal"></highlight></codeline>
<codeline lineno="211" refid="namespacetopi_1aa350ed41a0a28c5c90db8ec48b7c3bd2" refkind="member"><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1te_1_1Tensor" kindref="compound">Tensor</ref><sp/><ref refid="namespacetopi_1aa350ed41a0a28c5c90db8ec48b7c3bd2" kindref="member">CommReduceIdx</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1te_1_1Tensor" kindref="compound">Tensor</ref>&amp;<sp/>data,</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;Integer&gt;</ref>&amp;<sp/>axis,</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacetopi_1a8baac534d5ff12a20f089736a0e60f14" kindref="member">FCommReduce</ref><sp/>func,</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>keepdims,</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>atleast1d)<sp/>{</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>ndim<sp/>=<sp/>data-&gt;<ref refid="classtvm_1_1te_1_1TensorNode_1a0ba732bc2def0d467854585752911351" kindref="member">shape</ref>.size();</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/>CHECK_NE(ndim,<sp/>0)<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;Cannot<sp/>reduce<sp/>a<sp/>0<sp/>dim<sp/>Tensor&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>real_axis<sp/>=<sp/><ref refid="namespacetopi_1a2c7364c2934ba1b64d9d9a5837e77497" kindref="member">GetRealAxis</ref>(static_cast&lt;int&gt;(ndim),<sp/>axis);</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>reduce_axes<sp/>=<sp/><ref refid="namespacetopi_1aa9ac5704585fb8f3592081e0833c9163" kindref="member">MakeReduceAxes</ref>(real_axis,<sp/>data);</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>target_shape<sp/>=<sp/><ref refid="namespacetopi_1ab69e23e61282f3e99cacf20b55c57d13" kindref="member">MakeReduceTargetShape</ref>(real_axis,<sp/>data,<sp/>keepdims,<sp/>atleast1d);</highlight></codeline>
<codeline lineno="221"><highlight class="normal"></highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/><ref refid="namespacetvm_1_1te_1aeacae1afc9dd1267cbb5779f9daa4671" kindref="member">compute</ref><sp/>=<sp/>[ndim,<sp/>keepdims,<sp/>&amp;real_axis,<sp/>&amp;reduce_axes,<sp/>&amp;func,<sp/>&amp;data]</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;Var&gt;</ref>&amp;<sp/>indices)<sp/>{</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;PrimExpr&gt;</ref><sp/>eval_range;</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;PrimExpr&gt;</ref><sp/>eval_indices;</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>arg_counter<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>red_counter<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="228"><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>ndim;<sp/>++i)<sp/>{</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(std::find(real_axis.begin(),<sp/>real_axis.end(),<sp/>i)<sp/>!=<sp/>real_axis.end())<sp/>{</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>real_axis<sp/>contains<sp/>i</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eval_range.<ref refid="classtvm_1_1Array_1a24d5ac1f6730d46cb1a6d16729f0a7bb" kindref="member">push_back</ref>(reduce_axes[red_counter]);</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eval_indices.<ref refid="classtvm_1_1Array_1a24d5ac1f6730d46cb1a6d16729f0a7bb" kindref="member">push_back</ref>(reduce_axes[red_counter]-&gt;<ref refid="namespacetvm_1_1te_1ae0c71f84710b436cbe0b32289d0838f4" kindref="member">var</ref>);</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>red_counter++;</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!keepdims)<sp/>{</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eval_range.<ref refid="classtvm_1_1Array_1a24d5ac1f6730d46cb1a6d16729f0a7bb" kindref="member">push_back</ref>(indices[arg_counter]);</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>arg_counter++;</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eval_range.<ref refid="classtvm_1_1Array_1a24d5ac1f6730d46cb1a6d16729f0a7bb" kindref="member">push_back</ref>(indices[i]);</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="244"><highlight class="normal"></highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;PrimExpr&gt;</ref><sp/>ravel_shape;</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>i<sp/>:<sp/>real_axis)<sp/>{</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ravel_shape.<ref refid="classtvm_1_1Array_1a24d5ac1f6730d46cb1a6d16729f0a7bb" kindref="member">push_back</ref>(data-&gt;<ref refid="classtvm_1_1te_1_1TensorNode_1a0ba732bc2def0d467854585752911351" kindref="member">shape</ref>[i]);</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>idx<sp/>=<sp/>detail::RavelIndex(eval_indices,<sp/>ravel_shape);</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>func({<sp/>idx,<sp/>data(eval_range)<sp/>},<sp/>reduce_axes,<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/>};</highlight></codeline>
<codeline lineno="252"><highlight class="normal"></highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>temp_idx_val<sp/>=<sp/><ref refid="namespacetvm_1_1te_1aeacae1afc9dd1267cbb5779f9daa4671" kindref="member">tvm::te::compute</ref>(target_shape,<sp/><ref refid="namespacetvm_1_1te_1aeacae1afc9dd1267cbb5779f9daa4671" kindref="member">compute</ref>,</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data-&gt;<ref refid="classtvm_1_1te_1_1TensorNode_1a64faab73896ac7e9dd8dc43110920c7c" kindref="member">op</ref>-&gt;<ref refid="classtvm_1_1te_1_1OperationNode_1ad2fd6f140257f7b3c311f88374fa74d2" kindref="member">name</ref><sp/>+<sp/></highlight><highlight class="stringliteral">&quot;_red_temp&quot;</highlight><highlight class="normal">,<sp/><ref refid="namespacetopi_1aaf18db0af5abc7dd13818115bac402bc" kindref="member">kCommReduceIdx</ref>);</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>temp_idx<sp/>=<sp/>temp_idx_val[0];</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>temp_val<sp/>=<sp/>temp_idx_val[1];</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="namespacetvm_1_1te_1aeacae1afc9dd1267cbb5779f9daa4671" kindref="member">tvm::te::compute</ref>(</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/>target_shape,</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/>[&amp;temp_idx](</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;Var&gt;</ref>&amp;<sp/>indices)<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>temp_idx(indices);<sp/>},</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/>data-&gt;<ref refid="classtvm_1_1te_1_1TensorNode_1a64faab73896ac7e9dd8dc43110920c7c" kindref="member">op</ref>-&gt;<ref refid="classtvm_1_1te_1_1OperationNode_1ad2fd6f140257f7b3c311f88374fa74d2" kindref="member">name</ref><sp/>+<sp/></highlight><highlight class="stringliteral">&quot;_red&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespacetopi_1aaf18db0af5abc7dd13818115bac402bc" kindref="member">kCommReduceIdx</ref>);</highlight></codeline>
<codeline lineno="262"><highlight class="normal">}</highlight></codeline>
<codeline lineno="263"><highlight class="normal"></highlight></codeline>
<codeline lineno="265" refid="namespacetopi_1afa9b3b014bd552948f6fd671465901fa" refkind="member"><highlight class="keyword">using</highlight><highlight class="normal"><sp/><ref refid="namespacetopi_1afa9b3b014bd552948f6fd671465901fa" kindref="member">FCombine</ref><sp/>=<sp/>std::function&lt;Array&lt;PrimExpr&gt;(<ref refid="classtvm_1_1Array" kindref="compound">Array&lt;Var&gt;</ref><sp/>lhs,<sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;Var&gt;</ref><sp/>rhs)&gt;;</highlight></codeline>
<codeline lineno="266"><highlight class="normal"></highlight></codeline>
<codeline lineno="268" refid="namespacetopi_1a180676c7dc5c5716056719a58b60ca2c" refkind="member"><highlight class="keyword">using</highlight><highlight class="normal"><sp/><ref refid="namespacetopi_1a180676c7dc5c5716056719a58b60ca2c" kindref="member">FIdentity</ref><sp/>=<sp/>std::function&lt;Array&lt;PrimExpr&gt;(std::vector&lt;DataType&gt;<sp/>types)&gt;;</highlight></codeline>
<codeline lineno="269"><highlight class="normal"></highlight></codeline>
<codeline lineno="279" refid="namespacetopi_1aad827ce961a0d2cbafd181974e05b12d" refkind="member"><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="namespacetopi_1a8baac534d5ff12a20f089736a0e60f14" kindref="member">FCommReduce</ref><sp/><ref refid="namespacetopi_1aad827ce961a0d2cbafd181974e05b12d" kindref="member">MakeCommReducer</ref>(<ref refid="namespacetopi_1afa9b3b014bd552948f6fd671465901fa" kindref="member">FCombine</ref><sp/>fcombine,</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacetopi_1a180676c7dc5c5716056719a58b60ca2c" kindref="member">FIdentity</ref><sp/>fidentity,</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>std::string<sp/>name<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;reduce&quot;</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>[fcombine,<sp/>fidentity,<sp/>name]</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/>(<ref refid="classtvm_1_1Array" kindref="compound">Array&lt;PrimExpr&gt;</ref><sp/>exprs,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;IterVar&gt;</ref>&amp;<sp/>axis,<sp/><ref refid="classtvm_1_1PrimExpr" kindref="compound">PrimExpr</ref>*<sp/>condition)<sp/>{</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;Var&gt;</ref><sp/>lhs,<sp/>rhs;</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/>std::vector&lt;DataType&gt;<sp/>dtypes;</highlight></codeline>
<codeline lineno="286"><highlight class="normal"></highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>exprs.size();<sp/>++i)<sp/>{</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>dtype<sp/>=<sp/>exprs[i].dtype();</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>dtypes.<ref refid="classtvm_1_1Array_1a24d5ac1f6730d46cb1a6d16729f0a7bb" kindref="member">push_back</ref>(dtype);</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>lhs.<ref refid="classtvm_1_1Array_1a24d5ac1f6730d46cb1a6d16729f0a7bb" kindref="member">push_back</ref>(<ref refid="namespacetvm_1_1te_1ae0c71f84710b436cbe0b32289d0838f4" kindref="member">var</ref>(name<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;_lhs_&quot;</highlight><highlight class="normal"><sp/>+<sp/>std::to_string(i),<sp/>dtype));</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>rhs.<ref refid="classtvm_1_1Array_1a24d5ac1f6730d46cb1a6d16729f0a7bb" kindref="member">push_back</ref>(<ref refid="namespacetvm_1_1te_1ae0c71f84710b436cbe0b32289d0838f4" kindref="member">var</ref>(name<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;_rhs_&quot;</highlight><highlight class="normal"><sp/>+<sp/>std::to_string(i),<sp/>dtype));</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="293"><highlight class="normal"></highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>result<sp/>=<sp/>fcombine(lhs,<sp/>rhs);</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>id_elem<sp/>=<sp/>fidentity(dtypes);</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>cond<sp/>=<sp/>condition<sp/>!=<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal"><sp/>?<sp/>*condition<sp/>:<sp/><ref refid="namespacetvm_1_1tir_1ac40c127b53bca09d4c39f806a98dfdf8" kindref="member">tir::const_true</ref>();</highlight></codeline>
<codeline lineno="297"><highlight class="normal"></highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>combiner<sp/>=<sp/><ref refid="classtvm_1_1tir_1_1CommReducerNode_1a69338f35b7dcba5fa20d0595edd8e7b2" kindref="member">tvm::tir::CommReducerNode::make</ref>(lhs,<sp/>rhs,<sp/>result,<sp/>id_elem);</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;PrimExpr&gt;</ref><sp/>outputs;</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>exprs.size();<sp/>++i)<sp/>{</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>outputs.<ref refid="classtvm_1_1Array_1a24d5ac1f6730d46cb1a6d16729f0a7bb" kindref="member">push_back</ref>(</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classtvm_1_1tir_1_1ReduceNode_1a9cdfb176503a1b2a70d5bb1f452470a2" kindref="member">tvm::tir::ReduceNode::make</ref>(combiner,<sp/>exprs,<sp/>axis,<sp/>cond,<sp/>static_cast&lt;int&gt;(i)));</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>outputs;</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/>};</highlight></codeline>
<codeline lineno="306"><highlight class="normal">}</highlight></codeline>
<codeline lineno="307"><highlight class="normal"></highlight></codeline>
<codeline lineno="309" refid="namespacetopi_1a6c5fe35d3ea473bad1b9bed302a52dd3" refkind="member"><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1PrimExpr" kindref="compound">PrimExpr</ref><sp/><ref refid="namespacetopi_1a6c5fe35d3ea473bad1b9bed302a52dd3" kindref="member">MinOp</ref>(<ref refid="classtvm_1_1PrimExpr" kindref="compound">PrimExpr</ref><sp/>source,<sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;IterVar&gt;</ref><sp/>axis)<sp/>{</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="namespacetvm_1a9da780393e228969f77aa7550520a582" kindref="member">tvm::min</ref>(source,<sp/>axis);</highlight></codeline>
<codeline lineno="311"><highlight class="normal">}</highlight></codeline>
<codeline lineno="312"><highlight class="normal"></highlight></codeline>
<codeline lineno="314" refid="namespacetopi_1acb514e2dc2e6d45d6a4c5f0670b367e1" refkind="member"><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1PrimExpr" kindref="compound">PrimExpr</ref><sp/><ref refid="namespacetopi_1acb514e2dc2e6d45d6a4c5f0670b367e1" kindref="member">MaxOp</ref>(<ref refid="classtvm_1_1PrimExpr" kindref="compound">PrimExpr</ref><sp/>source,<sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;IterVar&gt;</ref><sp/>axis)<sp/>{</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="namespacetvm_1ab49bad0808ba033343e72ba37b39af2e" kindref="member">tvm::max</ref>(source,<sp/>axis);<sp/><sp/></highlight><highlight class="comment">//<sp/>NOLINT(*)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="316"><highlight class="normal">}</highlight></codeline>
<codeline lineno="317"><highlight class="normal"></highlight></codeline>
<codeline lineno="319" refid="namespacetopi_1afef081e81c9674d23b70aeced0df44a9" refkind="member"><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1PrimExpr" kindref="compound">PrimExpr</ref><sp/><ref refid="namespacetopi_1afef081e81c9674d23b70aeced0df44a9" kindref="member">ProdOp</ref>(<ref refid="classtvm_1_1PrimExpr" kindref="compound">PrimExpr</ref><sp/>source,<sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;IterVar&gt;</ref><sp/>axis)<sp/>{</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="namespacetvm_1afd8718fe1f413ab2850cdbb66adfbecc" kindref="member">tvm::prod</ref>(source,<sp/>axis);<sp/><sp/></highlight><highlight class="comment">//<sp/>NOLINT(*)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="321"><highlight class="normal">}</highlight></codeline>
<codeline lineno="322"><highlight class="normal"></highlight></codeline>
<codeline lineno="336" refid="namespacetopi_1a21ec078212b70fdbf3ff44188d9e2ee9" refkind="member"><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1te_1_1Tensor" kindref="compound">Tensor</ref><sp/><ref refid="namespacetopi_1a21ec078212b70fdbf3ff44188d9e2ee9" kindref="member">sum</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1te_1_1Tensor" kindref="compound">Tensor</ref>&amp;<sp/>data,</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;Integer&gt;</ref>&amp;<sp/>axis,</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>keepdims<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>atleast1d<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="namespacetopi_1a173c99250d923eff68fc63925b575497" kindref="member">CommReduce</ref>(data,<sp/>axis,<sp/><ref refid="namespacetvm_1a5cea5eb708bfbfa08e285092e5afdc33" kindref="member">tvm::sum</ref>,<sp/>keepdims,<sp/>atleast1d);</highlight></codeline>
<codeline lineno="341"><highlight class="normal">}</highlight></codeline>
<codeline lineno="342"><highlight class="normal"></highlight></codeline>
<codeline lineno="343" refid="namespacetopi_1a858c40c2e8ee578219b11a7a50287e9a" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1te_1_1Tensor" kindref="compound">Tensor</ref><sp/><ref refid="namespacetopi_1a858c40c2e8ee578219b11a7a50287e9a" kindref="member">collapse_sum</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1te_1_1Tensor" kindref="compound">Tensor</ref>&amp;<sp/>data,<sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;PrimExpr&gt;</ref><sp/>target_shape)<sp/>{</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/>CHECK_GE(data-&gt;<ref refid="classtvm_1_1te_1_1TensorNode_1a0ba732bc2def0d467854585752911351" kindref="member">shape</ref>.size(),<sp/>target_shape.<ref refid="classtvm_1_1Array_1a6c150ee7d3e46117b099d2052b19aec5" kindref="member">size</ref>());</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>ishape<sp/>=<sp/>detail::GetConstIntValues(data-&gt;<ref refid="classtvm_1_1te_1_1TensorNode_1a0ba732bc2def0d467854585752911351" kindref="member">shape</ref>,<sp/></highlight><highlight class="stringliteral">&quot;ishape&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>oshape<sp/>=<sp/>detail::GetConstIntValues(target_shape,<sp/></highlight><highlight class="stringliteral">&quot;oshape&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="347"><highlight class="normal"></highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/>std::vector&lt;int&gt;<sp/>reduce_axes;</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/>std::vector&lt;int&gt;<sp/>squeeze_axes;</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i_ax<sp/>=<sp/>ishape.size()<sp/>-<sp/>1,</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>o_ax<sp/>=<sp/>oshape.size()<sp/>-<sp/>1;<sp/>i_ax<sp/>&gt;=<sp/>0;<sp/>--i_ax)<sp/>{</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(o_ax<sp/>&gt;=<sp/>0<sp/>&amp;&amp;<sp/>ishape[i_ax]<sp/>==<sp/>oshape[o_ax])<sp/>{</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>--o_ax;</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/>reduce_axes.push_back(i_ax);</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(o_ax<sp/>&lt;<sp/>0)<sp/>{<sp/><sp/></highlight><highlight class="comment">//<sp/>squeeze<sp/>o_ax<sp/>if<sp/>was<sp/>added<sp/>during<sp/>expansion</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>squeeze_axes.push_back(i_ax);</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(oshape[o_ax]<sp/>==<sp/>1)<sp/>{</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>--o_ax;</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="363"><highlight class="normal"></highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(reduce_axes.size()<sp/>==<sp/>0)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="namespacetopi_1a4f5a29ac302ac31ce75e65f21ad60d41" kindref="member">topi::identity</ref>(data,<sp/></highlight><highlight class="stringliteral">&quot;tensor&quot;</highlight><highlight class="normal">,<sp/><ref refid="namespacetopi_1ae57dced7232a8ef1f94cd669c72e0093" kindref="member">kCommReduce</ref>);</highlight></codeline>
<codeline lineno="365"><highlight class="normal"></highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/>std::reverse(reduce_axes.begin(),<sp/>reduce_axes.end());</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/>std::reverse(squeeze_axes.begin(),<sp/>squeeze_axes.end());</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="namespacetopi_1ab5ae1df78350ee84b7dc49922523365d" kindref="member">DoCommReduce</ref>(data,<sp/><ref refid="namespacetvm_1a5cea5eb708bfbfa08e285092e5afdc33" kindref="member">tvm::sum</ref>,<sp/>target_shape,<sp/>reduce_axes,<sp/>squeeze_axes);</highlight></codeline>
<codeline lineno="369"><highlight class="normal">}</highlight></codeline>
<codeline lineno="370"><highlight class="normal"></highlight></codeline>
<codeline lineno="385" refid="namespacetopi_1a2c8bfc6d689aaa6408964342b30fcb29" refkind="member"><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1te_1_1Tensor" kindref="compound">Tensor</ref><sp/><ref refid="namespacetopi_1a2c8bfc6d689aaa6408964342b30fcb29" kindref="member">all</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1te_1_1Tensor" kindref="compound">Tensor</ref>&amp;<sp/>data,</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;Integer&gt;</ref>&amp;<sp/>axis,</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>keepdims<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>atleast1d<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="namespacetopi_1a173c99250d923eff68fc63925b575497" kindref="member">CommReduce</ref>(data,<sp/>axis,<sp/><ref refid="namespacetvm_1a78bab31ca3c44dbd5e6801e1e223d475" kindref="member">tvm::all</ref>,<sp/>keepdims,<sp/>atleast1d);</highlight></codeline>
<codeline lineno="390"><highlight class="normal">}</highlight></codeline>
<codeline lineno="391"><highlight class="normal"></highlight></codeline>
<codeline lineno="406" refid="namespacetopi_1a97cf9d42b53193d2c9d0e157a65d25db" refkind="member"><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1te_1_1Tensor" kindref="compound">Tensor</ref><sp/><ref refid="namespacetopi_1a97cf9d42b53193d2c9d0e157a65d25db" kindref="member">any</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1te_1_1Tensor" kindref="compound">Tensor</ref>&amp;<sp/>data,</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;Integer&gt;</ref>&amp;<sp/>axis,</highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>keepdims<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>atleast1d<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="namespacetopi_1a173c99250d923eff68fc63925b575497" kindref="member">CommReduce</ref>(data,<sp/>axis,<sp/><ref refid="namespacetvm_1a48629d1a87dfe0b51260defe79c82a60" kindref="member">tvm::any</ref>,<sp/>keepdims,<sp/>atleast1d);</highlight></codeline>
<codeline lineno="411"><highlight class="normal">}</highlight></codeline>
<codeline lineno="412"><highlight class="normal"></highlight></codeline>
<codeline lineno="427" refid="namespacetopi_1a97ecde12740d0c191ac029080ba9a74b" refkind="member"><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1te_1_1Tensor" kindref="compound">Tensor</ref><sp/><ref refid="namespacetopi_1a97ecde12740d0c191ac029080ba9a74b" kindref="member">min</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1te_1_1Tensor" kindref="compound">Tensor</ref>&amp;<sp/>data,</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;Integer&gt;</ref>&amp;<sp/>axis,</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>keepdims<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>atleast1d<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="namespacetopi_1a173c99250d923eff68fc63925b575497" kindref="member">CommReduce</ref>(data,<sp/>axis,<sp/><ref refid="namespacetopi_1a6c5fe35d3ea473bad1b9bed302a52dd3" kindref="member">MinOp</ref>,<sp/>keepdims,<sp/>atleast1d);</highlight></codeline>
<codeline lineno="432"><highlight class="normal">}</highlight></codeline>
<codeline lineno="433"><highlight class="normal"></highlight></codeline>
<codeline lineno="448" refid="namespacetopi_1a0683dcc462033f8daf87f939b05f250d" refkind="member"><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1te_1_1Tensor" kindref="compound">Tensor</ref><sp/><ref refid="namespacetopi_1a0683dcc462033f8daf87f939b05f250d" kindref="member">max</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1te_1_1Tensor" kindref="compound">Tensor</ref>&amp;<sp/>data,</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;Integer&gt;</ref>&amp;<sp/>axis,</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>keepdims<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>atleast1d<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="namespacetopi_1a173c99250d923eff68fc63925b575497" kindref="member">CommReduce</ref>(data,<sp/>axis,<sp/><ref refid="namespacetopi_1acb514e2dc2e6d45d6a4c5f0670b367e1" kindref="member">MaxOp</ref>,<sp/>keepdims,<sp/>atleast1d);</highlight></codeline>
<codeline lineno="453"><highlight class="normal">}</highlight></codeline>
<codeline lineno="454"><highlight class="normal"></highlight></codeline>
<codeline lineno="469" refid="namespacetopi_1a9a022c65050aa8fdab162cfb6775b865" refkind="member"><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1te_1_1Tensor" kindref="compound">Tensor</ref><sp/><ref refid="namespacetopi_1a9a022c65050aa8fdab162cfb6775b865" kindref="member">argmin</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1te_1_1Tensor" kindref="compound">Tensor</ref>&amp;<sp/>data,</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;Integer&gt;</ref>&amp;<sp/>axis,</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>keepdims<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>atleast1d<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>fcombine<sp/>=<sp/>[](<ref refid="classtvm_1_1Array" kindref="compound">Array&lt;Var&gt;</ref><sp/>lhs,<sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;Var&gt;</ref><sp/>rhs)<sp/>{</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;PrimExpr&gt;</ref><sp/>result;</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/>result.<ref refid="classtvm_1_1Array_1a24d5ac1f6730d46cb1a6d16729f0a7bb" kindref="member">push_back</ref>(<ref refid="classtvm_1_1tir_1_1SelectNode_1ae0809a88c56d20faceba05184b6e793b" kindref="member">tvm::tir::SelectNode::make</ref>(lhs[1]<sp/>&lt;=<sp/>rhs[1],<sp/>lhs[0],<sp/>rhs[0]));<sp/><sp/></highlight><highlight class="comment">//<sp/>idx</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/>result.<ref refid="classtvm_1_1Array_1a24d5ac1f6730d46cb1a6d16729f0a7bb" kindref="member">push_back</ref>(<ref refid="classtvm_1_1tir_1_1SelectNode_1ae0809a88c56d20faceba05184b6e793b" kindref="member">tvm::tir::SelectNode::make</ref>(lhs[1]<sp/>&lt;=<sp/>rhs[1],<sp/>lhs[1],<sp/>rhs[1]));<sp/><sp/></highlight><highlight class="comment">//<sp/>val</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/>};</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>fidentity<sp/>=<sp/>[](std::vector&lt;DataType&gt;<sp/>types)<sp/>{</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;PrimExpr&gt;</ref><sp/>result;</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/>result.<ref refid="classtvm_1_1Array_1a24d5ac1f6730d46cb1a6d16729f0a7bb" kindref="member">push_back</ref>(<ref refid="namespacetvm_1_1tir_1a4ea566597880d04bd62fbec687e338b5" kindref="member">tvm::tir::make_const</ref>(types[0],<sp/>-1));<sp/><sp/></highlight><highlight class="comment">//<sp/>idx</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/>result.<ref refid="classtvm_1_1Array_1a24d5ac1f6730d46cb1a6d16729f0a7bb" kindref="member">push_back</ref>(<ref refid="namespacetvm_1a2741c5a48b50bf369026a1bbdf02017f" kindref="member">tvm::max_value</ref>(types[1]));<sp/><sp/></highlight><highlight class="comment">//<sp/>val</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/>};</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>func<sp/>=<sp/><ref refid="namespacetopi_1aad827ce961a0d2cbafd181974e05b12d" kindref="member">MakeCommReducer</ref>(fcombine,<sp/>fidentity,<sp/></highlight><highlight class="stringliteral">&quot;argmin&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="namespacetopi_1aa350ed41a0a28c5c90db8ec48b7c3bd2" kindref="member">CommReduceIdx</ref>(data,<sp/>axis,<sp/>func,<sp/>keepdims,<sp/>atleast1d);</highlight></codeline>
<codeline lineno="487"><highlight class="normal">}</highlight></codeline>
<codeline lineno="488"><highlight class="normal"></highlight></codeline>
<codeline lineno="489" refid="namespacetopi_1af82f23bc79d3ecca9919b45568192d07" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="namespacetopi_1a8baac534d5ff12a20f089736a0e60f14" kindref="member">FCommReduce</ref><sp/><ref refid="namespacetopi_1af82f23bc79d3ecca9919b45568192d07" kindref="member">MakeArgmaxReducer</ref>()<sp/>{</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>fcombine<sp/>=<sp/>[](<ref refid="classtvm_1_1Array" kindref="compound">Array&lt;Var&gt;</ref><sp/>lhs,<sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;Var&gt;</ref><sp/>rhs)<sp/>{</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;PrimExpr&gt;</ref><sp/>result;</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/>result.<ref refid="classtvm_1_1Array_1a24d5ac1f6730d46cb1a6d16729f0a7bb" kindref="member">push_back</ref>(<ref refid="classtvm_1_1tir_1_1SelectNode_1ae0809a88c56d20faceba05184b6e793b" kindref="member">tvm::tir::SelectNode::make</ref>(lhs[1]<sp/>&gt;=<sp/>rhs[1],<sp/>lhs[0],<sp/>rhs[0]));<sp/><sp/></highlight><highlight class="comment">//<sp/>idx</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/>result.<ref refid="classtvm_1_1Array_1a24d5ac1f6730d46cb1a6d16729f0a7bb" kindref="member">push_back</ref>(<ref refid="classtvm_1_1tir_1_1SelectNode_1ae0809a88c56d20faceba05184b6e793b" kindref="member">tvm::tir::SelectNode::make</ref>(lhs[1]<sp/>&gt;=<sp/>rhs[1],<sp/>lhs[1],<sp/>rhs[1]));<sp/><sp/></highlight><highlight class="comment">//<sp/>val</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/>};</highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>fidentity<sp/>=<sp/>[](std::vector&lt;DataType&gt;<sp/>types)<sp/>{</highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;PrimExpr&gt;</ref><sp/>result;</highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/>result.<ref refid="classtvm_1_1Array_1a24d5ac1f6730d46cb1a6d16729f0a7bb" kindref="member">push_back</ref>(<ref refid="namespacetvm_1_1tir_1a4ea566597880d04bd62fbec687e338b5" kindref="member">tvm::tir::make_const</ref>(types[0],<sp/>-1));<sp/><sp/></highlight><highlight class="comment">//<sp/>idx</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="499"><highlight class="normal"><sp/><sp/><sp/><sp/>result.<ref refid="classtvm_1_1Array_1a24d5ac1f6730d46cb1a6d16729f0a7bb" kindref="member">push_back</ref>(<ref refid="namespacetvm_1a9c126a8dde0d4079713969ca574f172e" kindref="member">tvm::min_value</ref>(types[1]));<sp/><sp/></highlight><highlight class="comment">//<sp/>val</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/>};</highlight></codeline>
<codeline lineno="502"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="namespacetopi_1aad827ce961a0d2cbafd181974e05b12d" kindref="member">MakeCommReducer</ref>(fcombine,<sp/>fidentity,<sp/></highlight><highlight class="stringliteral">&quot;argmax&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="503"><highlight class="normal">}</highlight></codeline>
<codeline lineno="504"><highlight class="normal"></highlight></codeline>
<codeline lineno="519" refid="namespacetopi_1a94f412c82e4225050328fae33a3342f2" refkind="member"><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1te_1_1Tensor" kindref="compound">Tensor</ref><sp/><ref refid="namespacetopi_1a94f412c82e4225050328fae33a3342f2" kindref="member">argmax</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1te_1_1Tensor" kindref="compound">Tensor</ref>&amp;<sp/>data,</highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;Integer&gt;</ref>&amp;<sp/>axis,</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>keepdims<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>atleast1d<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>reducer<sp/>=<sp/><ref refid="namespacetopi_1af82f23bc79d3ecca9919b45568192d07" kindref="member">MakeArgmaxReducer</ref>();</highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="namespacetopi_1aa350ed41a0a28c5c90db8ec48b7c3bd2" kindref="member">CommReduceIdx</ref>(data,<sp/>axis,<sp/>reducer,<sp/>keepdims,<sp/>atleast1d);</highlight></codeline>
<codeline lineno="525"><highlight class="normal">}</highlight></codeline>
<codeline lineno="526"><highlight class="normal"></highlight></codeline>
<codeline lineno="540" refid="namespacetopi_1a6566893e24ac42a7704fac00efe59121" refkind="member"><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1te_1_1Tensor" kindref="compound">Tensor</ref><sp/><ref refid="namespacetopi_1a6566893e24ac42a7704fac00efe59121" kindref="member">prod</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1te_1_1Tensor" kindref="compound">Tensor</ref>&amp;<sp/>data,</highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classtvm_1_1Array" kindref="compound">Array&lt;Integer&gt;</ref>&amp;<sp/>axis,</highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>keepdims<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>atleast1d<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="namespacetopi_1a173c99250d923eff68fc63925b575497" kindref="member">CommReduce</ref>(data,<sp/>axis,<sp/><ref refid="namespacetopi_1afef081e81c9674d23b70aeced0df44a9" kindref="member">ProdOp</ref>,<sp/>keepdims,<sp/>atleast1d);</highlight></codeline>
<codeline lineno="545"><highlight class="normal">}</highlight></codeline>
<codeline lineno="546"><highlight class="normal"></highlight></codeline>
<codeline lineno="547"><highlight class="normal">}<sp/><sp/></highlight><highlight class="comment">//<sp/>namespace<sp/>topi</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="548"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/><sp/>//<sp/>TOPI_REDUCTION_H_</highlight></codeline>
    </programlisting>
    <location file="topi/include/topi/reduction.h"/>
  </compounddef>
</doxygen>
