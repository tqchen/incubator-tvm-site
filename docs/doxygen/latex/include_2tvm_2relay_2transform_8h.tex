\hypertarget{include_2tvm_2relay_2transform_8h}{}\section{include/tvm/relay/transform.h File Reference}
\label{include_2tvm_2relay_2transform_8h}\index{include/tvm/relay/transform.\+h@{include/tvm/relay/transform.\+h}}


Relay specific transformation passes.  


{\ttfamily \#include $<$tvm/relay/attrs/transform.\+h$>$}\\*
{\ttfamily \#include $<$tvm/ir/transform.\+h$>$}\\*
{\ttfamily \#include $<$tvm/relay/expr.\+h$>$}\\*
{\ttfamily \#include $<$tvm/relay/function.\+h$>$}\\*
{\ttfamily \#include $<$tvm/relay/op\+\_\+attr\+\_\+types.\+h$>$}\\*
{\ttfamily \#include $<$tvm/relay/op.\+h$>$}\\*
{\ttfamily \#include $<$string$>$}\\*
Include dependency graph for transform.\+h\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{include_2tvm_2relay_2transform_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=238pt]{include_2tvm_2relay_2transform_8h__dep__incl}
\end{center}
\end{figure}
\subsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
 \hyperlink{namespacetvm}{tvm}
\item 
 \hyperlink{namespacetvm_1_1relay}{tvm\+::relay}
\begin{DoxyCompactList}\small\item\em Relay\+: a high level functional IR for T\+VM. \end{DoxyCompactList}\item 
 \hyperlink{namespacetvm_1_1relay_1_1transform}{tvm\+::relay\+::transform}
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
using \hyperlink{namespacetvm_1_1relay_1_1transform_afa666ade112e9955059095d695238a9a}{tvm\+::relay\+::transform\+::\+Pass} = \hyperlink{classtvm_1_1transform_1_1Pass}{tvm\+::transform\+::\+Pass}
\item 
using \hyperlink{namespacetvm_1_1relay_1_1transform_aa695a8dfc3d5b087018ddd4ef1eb2487}{tvm\+::relay\+::transform\+::\+Pass\+Node} = \hyperlink{classtvm_1_1transform_1_1PassNode}{tvm\+::transform\+::\+Pass\+Node}
\item 
using \hyperlink{namespacetvm_1_1relay_1_1transform_aa405b5f11938fb8c4fa2ca21926edc9d}{tvm\+::relay\+::transform\+::\+Pass\+Info} = \hyperlink{classtvm_1_1transform_1_1PassInfo}{tvm\+::transform\+::\+Pass\+Info}
\item 
using \hyperlink{namespacetvm_1_1relay_1_1transform_aae88cd0ad69cf64c7e9caf0a0c8ebb45}{tvm\+::relay\+::transform\+::\+Pass\+Info\+Node} = \hyperlink{classtvm_1_1transform_1_1PassInfoNode}{tvm\+::transform\+::\+Pass\+Info\+Node}
\item 
using \hyperlink{namespacetvm_1_1relay_1_1transform_a744a05f8bba3c2ac238ba4569d926184}{tvm\+::relay\+::transform\+::\+Pass\+Context} = \hyperlink{classtvm_1_1transform_1_1PassContext}{tvm\+::transform\+::\+Pass\+Context}
\item 
using \hyperlink{namespacetvm_1_1relay_1_1transform_a72900733e0d3510ae61a1c287c2ec125}{tvm\+::relay\+::transform\+::\+Pass\+Context\+Node} = \hyperlink{classtvm_1_1transform_1_1PassContextNode}{tvm\+::transform\+::\+Pass\+Context\+Node}
\item 
using \hyperlink{namespacetvm_1_1relay_1_1transform_a3ae923037d22b4640b450c06e6c1e33e}{tvm\+::relay\+::transform\+::\+Sequential} = \hyperlink{classtvm_1_1transform_1_1Sequential}{tvm\+::transform\+::\+Sequential}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_aba687537c5fd54db0012c745bba74a85}{tvm\+::relay\+::transform\+::\+Create\+Function\+Pass} (const runtime\+::\+Typed\+Packed\+Func$<$ Function(Function, I\+R\+Module, Pass\+Context)$>$ \&pass\+\_\+func, int opt\+\_\+level, const std\+::string \&name, const \hyperlink{classtvm_1_1Array}{tvm\+::\+Array}$<$ \hyperlink{classtvm_1_1PrimExpr}{tvm\+::\+Prim\+Expr} $>$ \&required)
\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_aaa08e0ced82fc7efe515d610104b070c}{tvm\+::relay\+::transform\+::\+Dead\+Code\+Elimination} (bool inline\+\_\+once=false)
\begin{DoxyCompactList}\small\item\em Remove expressions which does not effect the program result. \end{DoxyCompactList}\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_ab6e60251741cca1e811564b2f03a4a5d}{tvm\+::relay\+::transform\+::\+Lazy\+Gradient\+Init} ()
\begin{DoxyCompactList}\small\item\em Convert all expressions of \hyperlink{classtvm_1_1TensorType}{Tensor\+Type} into Grad\+Cell, an algebraic data type defined in gradient.\+rly. \end{DoxyCompactList}\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_a41656c71a440f1f9c9eae0aa409d2b22}{tvm\+::relay\+::transform\+::\+Fold\+Constant} ()
\begin{DoxyCompactList}\small\item\em Fold constant expressions. \end{DoxyCompactList}\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_a2a6be6024a96a84f7230faa2519f1a97}{tvm\+::relay\+::transform\+::\+Fuse\+Ops} (int fuse\+\_\+opt\+\_\+level=-\/1)
\begin{DoxyCompactList}\small\item\em Fuse operations into expr into seperate functions. \end{DoxyCompactList}\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_a03b053f3d99d5c420ddc8492e6b987bf}{tvm\+::relay\+::transform\+::\+Rewrite\+Annotated\+Ops} (int fallback\+\_\+device)
\begin{DoxyCompactList}\small\item\em Rewrite the annotated program. \end{DoxyCompactList}\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_a8cb03cf00b2ddf25f183ab837cde713c}{tvm\+::relay\+::transform\+::\+To\+A\+Normal\+Form} ()
\begin{DoxyCompactList}\small\item\em turn a dataflow graph into Administrative Normal Form, or A-\/\+Normal Form (A\+NF). \end{DoxyCompactList}\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_ad90e4d6ac08b62ef553755e759d398fa}{tvm\+::relay\+::transform\+::\+To\+C\+PS} ()
\begin{DoxyCompactList}\small\item\em Turn an expression into continuation passing style(\+C\+P\+S). \end{DoxyCompactList}\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_a2cfef0e02cca22f3e0e85e0a10a82f5b}{tvm\+::relay\+::transform\+::\+To\+Graph\+Normal\+Form} ()
\begin{DoxyCompactList}\small\item\em Remove let binding and directly share via pointer instead. \end{DoxyCompactList}\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_aa270d98da5518969e005c7e30d6eb6fe}{tvm\+::relay\+::transform\+::\+Partial\+Eval} ()
\begin{DoxyCompactList}\small\item\em Aggressive constant propagation/constant folding/inlining. \end{DoxyCompactList}\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_add13a2ad7b216ad4683141bbbb4f6943}{tvm\+::relay\+::transform\+::\+Simplify\+Inference} ()
\begin{DoxyCompactList}\small\item\em Simplify certain operators during inference. For example, batch norm will be unpacked into a number of simplified operators. \end{DoxyCompactList}\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_a22870dd16693b2e3edb5fba7cb5dc3e8}{tvm\+::relay\+::transform\+::\+Fast\+Math} ()
\begin{DoxyCompactList}\small\item\em Replaces non linear activation functions with their fast but approximate counterparts. \end{DoxyCompactList}\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_a1a4fe2161bf32a60bc2e57debab083ee}{tvm\+::relay\+::transform\+::\+Infer\+Type} ()
\begin{DoxyCompactList}\small\item\em Infer the type of an expression. \end{DoxyCompactList}\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_adf21ade01969835b155241d277a94d1c}{tvm\+::relay\+::transform\+::\+Eliminate\+Common\+Subexpr} (runtime\+::\+Packed\+Func fskip=nullptr)
\begin{DoxyCompactList}\small\item\em Search and eliminate common subexpression. For example, if there are two expressions evaluated to an identical value, a single variable is created and these two expressions are replaced by this variable. \end{DoxyCompactList}\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_a3b8f4cbf0bd699d2ca0ab92c534c867d}{tvm\+::relay\+::transform\+::\+Combine\+Parallel\+Conv2D} (uint64\+\_\+t min\+\_\+num\+\_\+branches=3)
\begin{DoxyCompactList}\small\item\em Combine parallel 2d convolutions into a single convolution if the number of branches of this conv2d operator is not less than {\ttfamily min\+\_\+num\+\_\+branch}. \end{DoxyCompactList}\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_a186d1029887d7b33d002798d414f4d31}{tvm\+::relay\+::transform\+::\+Combine\+Parallel\+Dense} (uint64\+\_\+t min\+\_\+num\+\_\+branches=3)
\begin{DoxyCompactList}\small\item\em Combine parallel dense ops into a single batch\+\_\+matmul if the number of branches of this dense operator is not less than {\ttfamily min\+\_\+num\+\_\+branch}. \end{DoxyCompactList}\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_a3bde64d7774dcda7735f73a4e2ebecf7}{tvm\+::relay\+::transform\+::\+Backward\+Fold\+Scale\+Axis} ()
\begin{DoxyCompactList}\small\item\em Backward fold axis scaling into weights of conv/dense operators. \end{DoxyCompactList}\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_aab7f62610e05ed0211f17d452ee37f5f}{tvm\+::relay\+::transform\+::\+Forward\+Fold\+Scale\+Axis} ()
\begin{DoxyCompactList}\small\item\em Forward fold axis scaling into weights of conv/dense operators. \end{DoxyCompactList}\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_a73946a29efe8cf6f186a681296c8e943}{tvm\+::relay\+::transform\+::\+Fold\+Scale\+Axis} ()
\begin{DoxyCompactList}\small\item\em A sequential pass that executes Forward\+Fold\+Scale\+Axis and Backward\+Fold\+Scale\+Axis passes. \end{DoxyCompactList}\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_adcddf150ca7da40e20408928421b0086}{tvm\+::relay\+::transform\+::\+Canonicalize\+Ops} ()
\begin{DoxyCompactList}\small\item\em Canonicalize some operators to the simplified operators. For example, bias\+\_\+add can be canonicalized to expand\+\_\+dims and broadcast\+\_\+add. \end{DoxyCompactList}\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_a64e0426cfa5887f11769a057c09ce8ba}{tvm\+::relay\+::transform\+::\+Alter\+Op\+Layout} ()
\begin{DoxyCompactList}\small\item\em Alternate the layouts of operators or replace primitive operators with other expressions. \end{DoxyCompactList}\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_ad12225e2ad26ae24fca669e180026689}{tvm\+::relay\+::transform\+::\+Convert\+Layout} (const std\+::string \&desired\+\_\+layout)
\begin{DoxyCompactList}\small\item\em Given a dest layout, this pass transforms the expr such that most of the ops input data layout is changed to the dest layout. In ideal situation, there are only 2 layout transforms, one at the start and one at the end. \end{DoxyCompactList}\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_a459fec81f00a7a17c5cf7dabe5e4e363}{tvm\+::relay\+::transform\+::\+Legalize} (const std\+::string \&legalize\+\_\+map\+\_\+attr\+\_\+name=\char`\"{}F\+T\+V\+M\+Legalize\char`\"{})
\begin{DoxyCompactList}\small\item\em Legalizes an expr with another expression. \end{DoxyCompactList}\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_a93bbf7ab3f612d4f38a6832d6b53b4fd}{tvm\+::relay\+::transform\+::\+Canonicalize\+Cast} ()
\begin{DoxyCompactList}\small\item\em Canonicalize cast expressions to make operator fusion more efficient. \end{DoxyCompactList}\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_a6e515696ecc9ff4222af99fef361de4e}{tvm\+::relay\+::transform\+::\+Eta\+Expand} (bool expand\+\_\+constructor, bool expand\+\_\+global\+\_\+var)
\begin{DoxyCompactList}\small\item\em Add abstraction over a constructor or global variable bound to a function. \end{DoxyCompactList}\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_a065b5d8be6fd8dbfcef44dfa48adeb29}{tvm\+::relay\+::transform\+::\+Print\+IR} (bool show\+\_\+meta\+\_\+data=true)
\begin{DoxyCompactList}\small\item\em Print the IR for a module to help debugging. \end{DoxyCompactList}\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_aac0bfdaf6d09b360602243c81abe05a1}{tvm\+::relay\+::transform\+::\+Partition\+Graph} ()
\begin{DoxyCompactList}\small\item\em Partition a Relay program into regions that can be executed on different backends. \end{DoxyCompactList}\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_aba5e588279a3b19a119c9aa28c364bbe}{tvm\+::relay\+::transform\+::\+Inline} ()
\begin{DoxyCompactList}\small\item\em Inline the global functions marked as {\ttfamily inline} in a given Relay \hyperlink{classtvm_1_1IRModule}{I\+R\+Module}. \end{DoxyCompactList}\item 
Pass \hyperlink{namespacetvm_1_1relay_1_1transform_abdccee126a74a602e3669bdfaf0f259c}{tvm\+::relay\+::transform\+::\+Remove\+Unused\+Functions} (Array$<$ \hyperlink{classtvm_1_1PrimExpr}{tvm\+::\+Prim\+Expr} $>$ entry\+\_\+functions)
\begin{DoxyCompactList}\small\item\em Remove the unused functions in the Relay \hyperlink{classtvm_1_1IRModule}{I\+R\+Module}. \end{DoxyCompactList}\item 
Expr \hyperlink{namespacetvm_1_1relay_ad7cfa0b6a4537989b886d47767526726}{tvm\+::relay\+::\+Bind} (const Expr \&expr, const \hyperlink{classtvm_1_1Map}{tvm\+::\+Map}$<$ Var, Expr $>$ \&binds)
\begin{DoxyCompactList}\small\item\em Bind the free variables to a Relay expression. This is a helper function usually called by other pass functions to help optimizations. \end{DoxyCompactList}\item 
Function \hyperlink{namespacetvm_1_1relay_a18141658f627685d55704609111f57be}{tvm\+::relay\+::\+Infer\+Type} (const Function \&f, const I\+R\+Module \&mod, const Global\+Var \&var)
\begin{DoxyCompactList}\small\item\em Infer the type of a function as if it is mapped to var in the mod. \end{DoxyCompactList}\item 
Expr \hyperlink{namespacetvm_1_1relay_ac36059b06a538598a8f46257c0cb9fe0}{tvm\+::relay\+::\+Forward\+Rewrite} (const Expr \&expr, const std\+::string \&rewrite\+\_\+map\+\_\+attr\+\_\+name, std\+::function$<$ Object\+Ref(const Call \&)$>$ fcontext=nullptr, std\+::function$<$ Expr(const Expr \&)$>$ fmulti\+\_\+ref\+\_\+trigger=nullptr)
\begin{DoxyCompactList}\small\item\em Apply rewrite rules to rewrite the expr in post D\+FS order. This function is used as a helper function to rewrtie an expression in a pass. \end{DoxyCompactList}\item 
Expr \hyperlink{namespacetvm_1_1relay_ae6b8ec762f81290872d611c40cc72458}{tvm\+::relay\+::\+Forward\+Rewrite} (const Expr \&expr, const F\+Forward\+Rewrite \&rewrite\+\_\+func, std\+::function$<$ Object\+Ref(const Call \&)$>$ fcontext=nullptr, std\+::function$<$ Expr(const Expr \&)$>$ fmulti\+\_\+ref\+\_\+trigger=nullptr)
\begin{DoxyCompactList}\small\item\em Apply rewrite rules to rewrite the expr in post D\+FS order. This function is used as a helper function to rewrtie an expression in a pass. \end{DoxyCompactList}\item 
Expr \hyperlink{namespacetvm_1_1relay_a7917e50fbb560a15995e8a617d65d1ab}{tvm\+::relay\+::\+Rewrite\+Annotated\+Ops} (const Expr \&expr, int fallback\+\_\+device)
\begin{DoxyCompactList}\small\item\em Rewrite the annotated program. \end{DoxyCompactList}\item 
Function \hyperlink{namespacetvm_1_1relay_ab9548d99857f7698f4fe64d056dcd46a}{tvm\+::relay\+::\+To\+C\+PS} (const Function \&f, const I\+R\+Module \&mod)
\begin{DoxyCompactList}\small\item\em Turn an expression into continuation passing style(\+C\+P\+S). \end{DoxyCompactList}\item 
Function \hyperlink{namespacetvm_1_1relay_a1677d450d58078811f52fd70d67db515}{tvm\+::relay\+::\+Un\+C\+PS} (const Function \&f)
\begin{DoxyCompactList}\small\item\em Remove the continuation argument of a C\+PS function. \end{DoxyCompactList}\item 
Expr \hyperlink{namespacetvm_1_1relay_a1ecbcbe35c7abd82b9eabf94f6b797d2}{tvm\+::relay\+::\+De\+Dup} (const Expr \&e)
\begin{DoxyCompactList}\small\item\em Deduplicate the bound variables and type variables in the expression. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Relay specific transformation passes. 

