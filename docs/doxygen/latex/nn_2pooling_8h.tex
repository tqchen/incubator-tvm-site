\hypertarget{nn_2pooling_8h}{}\section{topi/include/topi/nn/pooling.h File Reference}
\label{nn_2pooling_8h}\index{topi/include/topi/nn/pooling.\+h@{topi/include/topi/nn/pooling.\+h}}


Pooling op constructions.  


{\ttfamily \#include $<$topi/detail/pad\+\_\+utils.\+h$>$}\\*
{\ttfamily \#include $<$topi/nn.\+h$>$}\\*
{\ttfamily \#include $<$topi/reduction.\+h$>$}\\*
{\ttfamily \#include $<$topi/tags.\+h$>$}\\*
{\ttfamily \#include $<$tvm/tir/ir\+\_\+pass.\+h$>$}\\*
{\ttfamily \#include $<$algorithm$>$}\\*
{\ttfamily \#include $<$string$>$}\\*
{\ttfamily \#include $<$vector$>$}\\*
Include dependency graph for pooling.\+h\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{nn_2pooling_8h__incl}
\end{center}
\end{figure}
\subsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
 \hyperlink{namespacetopi}{topi}
\item 
 \hyperlink{namespacetopi_1_1nn}{topi\+::nn}
\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{namespacetopi_1_1nn_ac531cfce9c3a031fa25cfb6ed1f9b95b}{topi\+::nn\+::\+Pool\+Type} \+: int \{ \hyperlink{namespacetopi_1_1nn_ac531cfce9c3a031fa25cfb6ed1f9b95babbfb6c4315c8b57e558600af1515d3d8}{topi\+::nn\+::k\+Avg\+Pool}, 
\hyperlink{namespacetopi_1_1nn_ac531cfce9c3a031fa25cfb6ed1f9b95ba3a406a1361a3c7ca311d3c514842c2f4}{topi\+::nn\+::k\+Max\+Pool}
 \}\begin{DoxyCompactList}\small\item\em Pooling type. \end{DoxyCompactList}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classtvm_1_1te_1_1Tensor}{Tensor} \hyperlink{namespacetopi_1_1nn_ad51533b09956d7bc8de2537adf3b6b77}{topi\+::nn\+::pool\+\_\+impl} (const \hyperlink{classtvm_1_1te_1_1Tensor}{Tensor} \&x, const \hyperlink{classtvm_1_1Array}{Array}$<$ \hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} $>$ \&kernel\+\_\+size, const \hyperlink{classtvm_1_1Array}{Array}$<$ \hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} $>$ \&stride\+\_\+size, const \hyperlink{classtvm_1_1Array}{Array}$<$ \hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} $>$ \&padding\+\_\+size, Pool\+Type pool\+\_\+type, bool ceil\+\_\+mode, const size\+\_\+t height\+\_\+axis, const size\+\_\+t width\+\_\+axis, bool count\+\_\+include\+\_\+pad)
\begin{DoxyCompactList}\small\item\em Perform pooling on height and width dimension of data. \end{DoxyCompactList}\item 
\hyperlink{classtvm_1_1te_1_1Tensor}{Tensor} \hyperlink{namespacetopi_1_1nn_af2c25e8b3ab3cac1c2896cb750838337}{topi\+::nn\+::pool\+\_\+grad\+\_\+impl} (const \hyperlink{classtvm_1_1te_1_1Tensor}{Tensor} \&out\+\_\+grad, const \hyperlink{classtvm_1_1te_1_1Tensor}{Tensor} \&x, const \hyperlink{classtvm_1_1Array}{Array}$<$ \hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} $>$ \&kernel\+\_\+size, const \hyperlink{classtvm_1_1Array}{Array}$<$ \hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} $>$ \&stride\+\_\+size, const \hyperlink{classtvm_1_1Array}{Array}$<$ \hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} $>$ \&padding\+\_\+size, Pool\+Type pool\+\_\+type, bool ceil\+\_\+mode, const size\+\_\+t height\+\_\+axis, const size\+\_\+t width\+\_\+axis, bool count\+\_\+include\+\_\+pad)
\item 
bool \hyperlink{namespacetopi_1_1nn_a2e81a7938a1e3f273e184e2373d9138d}{topi\+::nn\+::find\+\_\+depth\+\_\+height\+\_\+width} (const std\+::string \&layout, int $\ast$depth\+\_\+axis, int $\ast$height\+\_\+axis, int $\ast$width\+\_\+axis)
\item 
bool \hyperlink{namespacetopi_1_1nn_a428e0ba6800ef89b8c1f97f0245e244d}{topi\+::nn\+::find\+\_\+height\+\_\+width} (const std\+::string \&layout, int $\ast$height\+\_\+axis, int $\ast$width\+\_\+axis)
\item 
bool \hyperlink{namespacetopi_1_1nn_ab1f1f9f86723b30bb8997615e1d63ca8}{topi\+::nn\+::find\+\_\+width} (const std\+::string \&layout, int $\ast$width\+\_\+axis)
\item 
\hyperlink{classtvm_1_1te_1_1Tensor}{Tensor} \hyperlink{namespacetopi_1_1nn_ac1708b3aa1a677f56a4063a568945d98}{topi\+::nn\+::pool} (const \hyperlink{classtvm_1_1te_1_1Tensor}{Tensor} \&x, const \hyperlink{classtvm_1_1Array}{Array}$<$ \hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} $>$ \&kernel\+\_\+size, const \hyperlink{classtvm_1_1Array}{Array}$<$ \hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} $>$ \&stride\+\_\+size, const \hyperlink{classtvm_1_1Array}{Array}$<$ \hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} $>$ \&padding\+\_\+size, Pool\+Type pool\+\_\+type, bool ceil\+\_\+mode, const std\+::string \&layout=\char`\"{}N\+C\+HW\char`\"{}, bool count\+\_\+include\+\_\+pad=true)
\begin{DoxyCompactList}\small\item\em Perform pooling on height and width dimension of data. It decides the height and width dimension according to the layout string, in which \textquotesingle{}W\textquotesingle{} and \textquotesingle{}H\textquotesingle{} means width and height respectively. Width and height dimension cannot be split. For example, N\+C\+HW, N\+C\+H\+W16c, etc. are valid for pool, while N\+C\+H\+W16w, N\+C\+H\+W16h are not. See {\itshape layout} for more information of the layout string convention. \end{DoxyCompactList}\item 
\hyperlink{classtvm_1_1te_1_1Tensor}{Tensor} \hyperlink{namespacetopi_1_1nn_a4f915567f195ade4a17743a5e7654e88}{topi\+::nn\+::pool\+\_\+grad} (const \hyperlink{classtvm_1_1te_1_1Tensor}{Tensor} \&out\+\_\+grad, const \hyperlink{classtvm_1_1te_1_1Tensor}{Tensor} \&x, const \hyperlink{classtvm_1_1Array}{Array}$<$ \hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} $>$ \&kernel\+\_\+size, const \hyperlink{classtvm_1_1Array}{Array}$<$ \hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} $>$ \&stride\+\_\+size, const \hyperlink{classtvm_1_1Array}{Array}$<$ \hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} $>$ \&padding\+\_\+size, Pool\+Type pool\+\_\+type, bool ceil\+\_\+mode, const std\+::string \&layout=\char`\"{}N\+C\+HW\char`\"{}, bool count\+\_\+include\+\_\+pad=true)
\begin{DoxyCompactList}\small\item\em Calculate gradient of pooling on height and width dimension of data. It decides the height and width dimension according to the layout string, in which \textquotesingle{}W\textquotesingle{} and \textquotesingle{}H\textquotesingle{} means width and height respectively. Width and height dimension cannot be split. For example, N\+C\+HW, N\+C\+H\+W16c, etc. are valid for pool, while N\+C\+H\+W16w, N\+C\+H\+W16h are not. See {\itshape layout} for more information of the layout string convention. \end{DoxyCompactList}\item 
\hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} \hyperlink{namespacetopi_1_1nn_a91b52c68356d23123474ebf10f9b0140}{topi\+::nn\+::start\+\_\+index} (const Var \&out\+\_\+index, const \hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} \&odim, const \hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} \&idim)
\item 
\hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} \hyperlink{namespacetopi_1_1nn_aadbaaec56f0b485262bf5199bbe3dcb3}{topi\+::nn\+::end\+\_\+index} (const Var \&out\+\_\+index, const \hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} \&odim, const \hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} \&idim)
\item 
\hyperlink{classtvm_1_1te_1_1Tensor}{Tensor} \hyperlink{namespacetopi_1_1nn_ad4f34df5cfa8dc75843116bc39f06066}{topi\+::nn\+::adaptive\+\_\+pool\+\_\+impl} (const \hyperlink{classtvm_1_1te_1_1Tensor}{Tensor} \&x, const \hyperlink{classtvm_1_1Array}{Array}$<$ \hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} $>$ \&output\+\_\+size, Pool\+Type pool\+\_\+type, const std\+::vector$<$ int $>$ \&axes)
\begin{DoxyCompactList}\small\item\em Perform adaptive pooling on N dimensional data. \end{DoxyCompactList}\item 
\hyperlink{classtvm_1_1te_1_1Tensor}{Tensor} \hyperlink{namespacetopi_1_1nn_af721a019c13f1f99dc43d5d49cc71388}{topi\+::nn\+::adaptive\+\_\+pool} (const \hyperlink{classtvm_1_1te_1_1Tensor}{Tensor} \&x, const \hyperlink{classtvm_1_1Array}{Array}$<$ \hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} $>$ \&output\+\_\+size, Pool\+Type pool\+\_\+type, const std\+::string \&layout=\char`\"{}N\+C\+HW\char`\"{})
\begin{DoxyCompactList}\small\item\em Adaptively perform pooling on height and width dimension of data. The pooling kernel and stride sizes are automatically chosen for desired output sizes. It decides the height and width dimension according to the layout string, in which \textquotesingle{}W\textquotesingle{} and \textquotesingle{}H\textquotesingle{} means width and height respectively. Width and height dimension cannot be split. For example, N\+C\+HW, N\+C\+H\+W16c, etc. are valid for pool, while N\+C\+H\+W16w, N\+C\+H\+W16h are not. See {\itshape layout} for more information of the layout string convention. \end{DoxyCompactList}\item 
\hyperlink{classtvm_1_1te_1_1Tensor}{Tensor} \hyperlink{namespacetopi_1_1nn_ad48c57c26ce6bb02576555a4cb11bcd3}{topi\+::nn\+::adaptive\+\_\+pool3d} (const \hyperlink{classtvm_1_1te_1_1Tensor}{Tensor} \&x, const \hyperlink{classtvm_1_1Array}{Array}$<$ \hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} $>$ \&output\+\_\+size, Pool\+Type pool\+\_\+type, const std\+::string \&layout=\char`\"{}N\+C\+D\+HW\char`\"{})
\begin{DoxyCompactList}\small\item\em Adaptively perform pooling on three dimensional data. See the two dimensional version above for details. \end{DoxyCompactList}\item 
\hyperlink{classtvm_1_1te_1_1Tensor}{Tensor} \hyperlink{namespacetopi_1_1nn_ac5fe64687aa8bffee420bf282f2b8f8c}{topi\+::nn\+::global\+\_\+pool} (const \hyperlink{classtvm_1_1te_1_1Tensor}{Tensor} \&x, Pool\+Type pool\+\_\+type, const std\+::string \&layout=\char`\"{}N\+C\+HW\char`\"{})
\begin{DoxyCompactList}\small\item\em Perform global pooling on height and width dimension of data. It decides the height and width dimension according to the layout string, in which \textquotesingle{}W\textquotesingle{} and \textquotesingle{}H\textquotesingle{} means width and height respectively. Width and height dimension cannot be split. For example, N\+C\+HW, N\+C\+H\+W16c, ... are valid for global\+\_\+pool, while N\+C\+H\+W16w, N\+C\+H\+W16h are not. See {\itshape layout} for more information of the layout string convention. \end{DoxyCompactList}\item 
\hyperlink{classtvm_1_1te_1_1Tensor}{Tensor} \hyperlink{namespacetopi_1_1nn_a0b2681e29b1f733835ffe2e6b3b69c13}{topi\+::nn\+::pool\+\_\+impl\+\_\+nd} (const \hyperlink{classtvm_1_1te_1_1Tensor}{Tensor} \&x, const \hyperlink{classtvm_1_1Array}{Array}$<$ \hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} $>$ \&kernel\+\_\+size, const \hyperlink{classtvm_1_1Array}{Array}$<$ \hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} $>$ \&stride\+\_\+size, const \hyperlink{classtvm_1_1Array}{Array}$<$ \hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} $>$ \&padding\+\_\+size, Pool\+Type pool\+\_\+type, bool ceil\+\_\+mode, const std\+::vector$<$ int $>$ \&axis, bool count\+\_\+include\+\_\+pad)
\begin{DoxyCompactList}\small\item\em Perform pooling on N-\/dimension of data. \end{DoxyCompactList}\item 
\hyperlink{classtvm_1_1te_1_1Tensor}{Tensor} \hyperlink{namespacetopi_1_1nn_a379dfcc1d33774fb4ce998550dda187c}{topi\+::nn\+::pool1d} (const \hyperlink{classtvm_1_1te_1_1Tensor}{Tensor} \&x, const \hyperlink{classtvm_1_1Array}{Array}$<$ \hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} $>$ \&kernel\+\_\+size, const \hyperlink{classtvm_1_1Array}{Array}$<$ \hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} $>$ \&stride\+\_\+size, const \hyperlink{classtvm_1_1Array}{Array}$<$ \hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} $>$ \&padding\+\_\+size, Pool\+Type pool\+\_\+type, bool ceil\+\_\+mode, const std\+::string \&layout=\char`\"{}N\+CW\char`\"{}, bool count\+\_\+include\+\_\+pad=true)
\begin{DoxyCompactList}\small\item\em Perform pooling on the width dimension of data. Width axis is determined by the layout string in which \textquotesingle{}W\textquotesingle{} means width. Width dimension cannot be split. For example, N\+CW, N\+C\+W16c, etc. are valid for pool, while N\+C\+W16w is not. See {\itshape layout} for more information of the layout string convention. \end{DoxyCompactList}\item 
\hyperlink{classtvm_1_1te_1_1Tensor}{Tensor} \hyperlink{namespacetopi_1_1nn_af84c2ac0c1fd4ec7db5c9bc661bd5aab}{topi\+::nn\+::pool3d} (const \hyperlink{classtvm_1_1te_1_1Tensor}{Tensor} \&x, const \hyperlink{classtvm_1_1Array}{Array}$<$ \hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} $>$ \&kernel\+\_\+size, const \hyperlink{classtvm_1_1Array}{Array}$<$ \hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} $>$ \&stride\+\_\+size, const \hyperlink{classtvm_1_1Array}{Array}$<$ \hyperlink{classtvm_1_1PrimExpr}{Prim\+Expr} $>$ \&padding\+\_\+size, Pool\+Type pool\+\_\+type, bool ceil\+\_\+mode, const std\+::string \&layout=\char`\"{}N\+C\+D\+HW\char`\"{}, bool count\+\_\+include\+\_\+pad=true)
\begin{DoxyCompactList}\small\item\em Perform pooling on depth, height and width dimension of data. It decides the depth, height and width dimension according to the layout string, in which \textquotesingle{}D\textquotesingle{}, \textquotesingle{}W\textquotesingle{} and \textquotesingle{}H\textquotesingle{} means depth, width and height respectively. Depth, Width and height dimension cannot be split. For example, N\+C\+D\+HW, N\+C\+D\+H\+W16c, etc. are valid for pool, while N\+C\+D\+H\+W16d, N\+C\+D\+H\+W16w or N\+C\+D\+H\+W16h are not. See {\itshape layout} for more information of the layout string convention. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Pooling op constructions. 

