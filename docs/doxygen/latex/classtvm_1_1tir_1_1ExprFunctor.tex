\hypertarget{classtvm_1_1tir_1_1ExprFunctor}{}\section{tvm\+:\+:tir\+:\+:Expr\+Functor$<$ F\+Type $>$ Class Template Reference}
\label{classtvm_1_1tir_1_1ExprFunctor}\index{tvm\+::tir\+::\+Expr\+Functor$<$ F\+Type $>$@{tvm\+::tir\+::\+Expr\+Functor$<$ F\+Type $>$}}


A dynamical functor that dispatches on in the first Expr argument. You can use this as a more powerful Visitor, since it allows you to define function signatures of Visit Function.  




{\ttfamily \#include $<$expr\+\_\+functor.\+h$>$}



Collaboration diagram for tvm\+:\+:tir\+:\+:Expr\+Functor$<$ F\+Type $>$\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=193pt]{classtvm_1_1tir_1_1ExprFunctor__coll__graph}
\end{center}
\end{figure}


\subsection{Detailed Description}
\subsubsection*{template$<$typename F\+Type$>$\\*
class tvm\+::tir\+::\+Expr\+Functor$<$ F\+Type $>$}

A dynamical functor that dispatches on in the first Expr argument. You can use this as a more powerful Visitor, since it allows you to define function signatures of Visit Function. 

This helps you to avoid to book-\/keep return value of Visitor via state, which can cause bugs easily when state is incorrectly maintained.


\begin{DoxyCode}
\textcolor{comment}{// A functor that set variable to b. and calculate results.}
\textcolor{keyword}{class }MyExprFunctor
  : \textcolor{keyword}{public} tir::ExprFunctor<int(const Expr&, int)> \{
 \textcolor{keyword}{public}:
  \textcolor{keywordtype}{int} VisitExpr\_(\textcolor{keyword}{const} Variable* op, \textcolor{keywordtype}{int} b) \textcolor{keyword}{final} \{
   \textcolor{keywordflow}{return} b;
  \}
  \textcolor{keywordtype}{int} VisitExpr\_(\textcolor{keyword}{const} IntImm* op, \textcolor{keywordtype}{int} b) \textcolor{keyword}{final} \{
    \textcolor{keywordflow}{return} op->value;
  \}
  \textcolor{keywordtype}{int} VisitExpr\_(\textcolor{keyword}{const} Add* op, \textcolor{keywordtype}{int} b) \textcolor{keyword}{final} \{
   \textcolor{keywordflow}{return} Visit(op->a, b) + Visit(op->b, b);
  \}
\};
MyExprFunctor f;
Var x(\textcolor{stringliteral}{"x"});
CHECK\_EQ(f(x + 1, 2), 3);
\end{DoxyCode}


\begin{DoxyNote}{Note}
Why do we need this more powerful Functor\+:
\end{DoxyNote}
We often need to implement a transformer tasks. Say we want to take Expr and transform it to some analysis result, This easily be done incorrectly using plain Visitor. See I\+R\+Visitor\textquotesingle{}s document for possible error cases.


\begin{DoxyTemplParams}{Template Parameters}
{\em F\+Type} & function signiture This type if only defined for F\+Type with function signiture R(const Expr\&, Args...) \\
\hline
\end{DoxyTemplParams}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
include/tvm/tir/\hyperlink{tir_2expr__functor_8h}{expr\+\_\+functor.\+h}\end{DoxyCompactItemize}
