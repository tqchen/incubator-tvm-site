\hypertarget{packed__func_8h}{}\section{include/tvm/runtime/packed\+\_\+func.h File Reference}
\label{packed__func_8h}\index{include/tvm/runtime/packed\+\_\+func.\+h@{include/tvm/runtime/packed\+\_\+func.\+h}}


Type-\/erased function used across T\+VM A\+PI.  


{\ttfamily \#include $<$dmlc/logging.\+h$>$}\\*
{\ttfamily \#include $<$tvm/runtime/c\+\_\+runtime\+\_\+api.\+h$>$}\\*
{\ttfamily \#include $<$tvm/runtime/module.\+h$>$}\\*
{\ttfamily \#include $<$tvm/runtime/ndarray.\+h$>$}\\*
{\ttfamily \#include $<$tvm/runtime/data\+\_\+type.\+h$>$}\\*
{\ttfamily \#include $<$tvm/runtime/object.\+h$>$}\\*
{\ttfamily \#include $<$functional$>$}\\*
{\ttfamily \#include $<$tuple$>$}\\*
{\ttfamily \#include $<$vector$>$}\\*
{\ttfamily \#include $<$string$>$}\\*
{\ttfamily \#include $<$limits$>$}\\*
{\ttfamily \#include $<$memory$>$}\\*
{\ttfamily \#include $<$utility$>$}\\*
{\ttfamily \#include $<$type\+\_\+traits$>$}\\*
Include dependency graph for packed\+\_\+func.\+h\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{packed__func_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{packed__func_8h__dep__incl}
\end{center}
\end{figure}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{classtvm_1_1runtime_1_1PackedFunc}{tvm\+::runtime\+::\+Packed\+Func}
\begin{DoxyCompactList}\small\item\em Packed function is a type-\/erased function. The arguments are passed by packed format. \end{DoxyCompactList}\item 
class \hyperlink{classtvm_1_1runtime_1_1TypedPackedFunc}{tvm\+::runtime\+::\+Typed\+Packed\+Func$<$ F\+Type $>$}
\begin{DoxyCompactList}\small\item\em Please refer to \hyperlink{classtvm_1_1runtime_1_1TypedPackedFunc_3_01R_07Args_8_8_8_08_4_TypedPackedFuncAnchor}{Typed\+Packed\+Func$<$R(Args..)$>$}. \end{DoxyCompactList}\item 
class \hyperlink{classtvm_1_1runtime_1_1TypedPackedFunc_3_01R_07Args_8_8_8_08_4}{tvm\+::runtime\+::\+Typed\+Packed\+Func$<$ R(\+Args...)$>$}
\begin{DoxyCompactList}\small\item\em A \hyperlink{classtvm_1_1runtime_1_1PackedFunc}{Packed\+Func} wrapper to provide typed function signature. It is backed by a \hyperlink{classtvm_1_1runtime_1_1PackedFunc}{Packed\+Func} internally. \end{DoxyCompactList}\item 
class \hyperlink{classtvm_1_1runtime_1_1TVMArgs}{tvm\+::runtime\+::\+T\+V\+M\+Args}
\begin{DoxyCompactList}\small\item\em Arguments into T\+VM functions. \end{DoxyCompactList}\item 
struct \hyperlink{structtvm_1_1runtime_1_1ObjectTypeChecker}{tvm\+::runtime\+::\+Object\+Type\+Checker$<$ T $>$}
\begin{DoxyCompactList}\small\item\em \hyperlink{classtvm_1_1Type}{Type} traits for runtime type check during F\+FI conversion. \end{DoxyCompactList}\item 
class \hyperlink{classtvm_1_1runtime_1_1TVMPODValue__}{tvm\+::runtime\+::\+T\+V\+M\+P\+O\+D\+Value\+\_\+}
\begin{DoxyCompactList}\small\item\em Internal base class to handle conversion to P\+OD values. \end{DoxyCompactList}\item 
class \hyperlink{classtvm_1_1runtime_1_1TVMArgValue}{tvm\+::runtime\+::\+T\+V\+M\+Arg\+Value}
\begin{DoxyCompactList}\small\item\em A single argument value to \hyperlink{classtvm_1_1runtime_1_1PackedFunc}{Packed\+Func}. Containing both type\+\_\+code and \hyperlink{unionTVMValue}{T\+V\+M\+Value}. \end{DoxyCompactList}\item 
class \hyperlink{classtvm_1_1runtime_1_1TVMRetValue}{tvm\+::runtime\+::\+T\+V\+M\+Ret\+Value}
\begin{DoxyCompactList}\small\item\em Return Value container, Unlike \hyperlink{classtvm_1_1runtime_1_1TVMArgValue}{T\+V\+M\+Arg\+Value}, which only holds reference and do not delete the underlying container during destruction. \end{DoxyCompactList}\item 
class \hyperlink{classtvm_1_1runtime_1_1TVMArgsSetter}{tvm\+::runtime\+::\+T\+V\+M\+Args\+Setter}
\end{DoxyCompactItemize}
\subsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
 \hyperlink{namespacetvm}{tvm}
\item 
 \hyperlink{namespacetvm_1_1runtime}{tvm\+::runtime}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{packed__func_8h_a50e8d21ff57c58c35bc4cc9310e64273}{T\+V\+M\+\_\+\+R\+U\+N\+T\+I\+M\+E\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+O\+N\+LY}~0
\item 
\#define \hyperlink{packed__func_8h_ad1e150bb815d5cb964e15d4fa7b5fd93}{T\+V\+M\+\_\+\+C\+H\+E\+C\+K\+\_\+\+T\+Y\+P\+E\+\_\+\+C\+O\+DE}(C\+O\+DE,  T)
\item 
\#define \hyperlink{packed__func_8h_aee75208638f500a4ce5e726c9d87d8ff}{T\+V\+M\+\_\+\+D\+L\+L\+\_\+\+E\+X\+P\+O\+R\+T\+\_\+\+P\+A\+C\+K\+E\+D\+\_\+\+F\+U\+NC}(Export\+Name,  Function)
\begin{DoxyCompactList}\small\item\em Export a function with the Packed\+Func signature as a Packed\+Func that can be loaded by Library\+Module. \end{DoxyCompactList}\item 
\#define \hyperlink{packed__func_8h_ae5b445392a64daa55bef53b4cf53025c}{T\+V\+M\+\_\+\+D\+L\+L\+\_\+\+E\+X\+P\+O\+R\+T\+\_\+\+T\+Y\+P\+E\+D\+\_\+\+F\+U\+NC}(Export\+Name,  Function)
\begin{DoxyCompactList}\small\item\em Export typed function as a Packed\+Func that can be loaded by Library\+Module. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
std\+::string \hyperlink{namespacetvm_1_1runtime_a06a49d761ea6373557c24c01eaceb07d}{tvm\+::runtime\+::\+Get\+Custom\+Type\+Name} (uint8\+\_\+t type\+\_\+code)
\begin{DoxyCompactList}\small\item\em Runtime utility for getting custom type name from code. \end{DoxyCompactList}\item 
bool \hyperlink{namespacetvm_1_1runtime_a1b8eedadc5a269b2f9614ce69a9932e7}{tvm\+::runtime\+::\+Get\+Custom\+Type\+Registered} (uint8\+\_\+t type\+\_\+code)
\begin{DoxyCompactList}\small\item\em Runtime utility for checking whether custom type is registered. \end{DoxyCompactList}\item 
uint8\+\_\+t \hyperlink{namespacetvm_1_1runtime_ac6d167947285dff3c780bd5d01ace9b9}{tvm\+::runtime\+::\+Parse\+Custom\+Datatype} (const std\+::string \&s, const char $\ast$$\ast$scan)
\begin{DoxyCompactList}\small\item\em Runtime utility for parsing string of the form \char`\"{}custom\mbox{[}$<$typename$>$\mbox{]}\char`\"{}. \end{DoxyCompactList}\item 
const char $\ast$ \hyperlink{namespacetvm_1_1runtime_a504dc7b1fd693412576703f44bcc3cfb}{tvm\+::runtime\+::\+Type\+Code2\+Str} (int type\+\_\+code)
\begin{DoxyCompactList}\small\item\em Convert type code to its name. \end{DoxyCompactList}\item 
D\+L\+Data\+Type \hyperlink{namespacetvm_1_1runtime_a277f104e659f71cd8885744700016341}{tvm\+::runtime\+::\+String2\+D\+L\+Data\+Type} (std\+::string s)
\begin{DoxyCompactList}\small\item\em convert a string to T\+VM type. \end{DoxyCompactList}\item 
std\+::string \hyperlink{namespacetvm_1_1runtime_ac360f2d9815036ab1b4d84d9cfb46b4f}{tvm\+::runtime\+::\+D\+L\+Data\+Type2\+String} (D\+L\+Data\+Type t)
\begin{DoxyCompactList}\small\item\em convert a T\+VM type to string. \end{DoxyCompactList}\item 
std\+::ostream \& \hyperlink{namespacetvm_1_1runtime_a11ed99740d7bb838d96617de83ff2363}{tvm\+::runtime\+::operator$<$$<$} (std\+::ostream \&os, D\+L\+Data\+Type t)
\item 
std\+::ostream \& \hyperlink{namespacetvm_1_1runtime_a59d447b7bdac52d26bca3422fe098f6f}{tvm\+::runtime\+::operator$<$$<$} (std\+::ostream \&os, const Data\+Type \&dtype)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Type-\/erased function used across T\+VM A\+PI. 



\subsection{Macro Definition Documentation}
\index{packed\+\_\+func.\+h@{packed\+\_\+func.\+h}!T\+V\+M\+\_\+\+C\+H\+E\+C\+K\+\_\+\+T\+Y\+P\+E\+\_\+\+C\+O\+DE@{T\+V\+M\+\_\+\+C\+H\+E\+C\+K\+\_\+\+T\+Y\+P\+E\+\_\+\+C\+O\+DE}}
\index{T\+V\+M\+\_\+\+C\+H\+E\+C\+K\+\_\+\+T\+Y\+P\+E\+\_\+\+C\+O\+DE@{T\+V\+M\+\_\+\+C\+H\+E\+C\+K\+\_\+\+T\+Y\+P\+E\+\_\+\+C\+O\+DE}!packed\+\_\+func.\+h@{packed\+\_\+func.\+h}}
\subsubsection[{\texorpdfstring{T\+V\+M\+\_\+\+C\+H\+E\+C\+K\+\_\+\+T\+Y\+P\+E\+\_\+\+C\+O\+DE}{TVM_CHECK_TYPE_CODE}}]{\setlength{\rightskip}{0pt plus 5cm}\#define T\+V\+M\+\_\+\+C\+H\+E\+C\+K\+\_\+\+T\+Y\+P\+E\+\_\+\+C\+O\+DE(
\begin{DoxyParamCaption}
\item[{}]{C\+O\+DE, }
\item[{}]{T}
\end{DoxyParamCaption}
)}\hypertarget{packed__func_8h_ad1e150bb815d5cb964e15d4fa7b5fd93}{}\label{packed__func_8h_ad1e150bb815d5cb964e15d4fa7b5fd93}
{\bfseries Value\+:}
\begin{DoxyCode}
CHECK\_EQ(CODE, T) << \textcolor{stringliteral}{" expected "}                            \(\backslash\)
  << \hyperlink{namespacetvm_1_1runtime_a504dc7b1fd693412576703f44bcc3cfb}{TypeCode2Str}(T) << \textcolor{stringliteral}{" but get "} << \hyperlink{namespacetvm_1_1runtime_a504dc7b1fd693412576703f44bcc3cfb}{TypeCode2Str}(CODE)      \(\backslash\)
\end{DoxyCode}
\index{packed\+\_\+func.\+h@{packed\+\_\+func.\+h}!T\+V\+M\+\_\+\+D\+L\+L\+\_\+\+E\+X\+P\+O\+R\+T\+\_\+\+P\+A\+C\+K\+E\+D\+\_\+\+F\+U\+NC@{T\+V\+M\+\_\+\+D\+L\+L\+\_\+\+E\+X\+P\+O\+R\+T\+\_\+\+P\+A\+C\+K\+E\+D\+\_\+\+F\+U\+NC}}
\index{T\+V\+M\+\_\+\+D\+L\+L\+\_\+\+E\+X\+P\+O\+R\+T\+\_\+\+P\+A\+C\+K\+E\+D\+\_\+\+F\+U\+NC@{T\+V\+M\+\_\+\+D\+L\+L\+\_\+\+E\+X\+P\+O\+R\+T\+\_\+\+P\+A\+C\+K\+E\+D\+\_\+\+F\+U\+NC}!packed\+\_\+func.\+h@{packed\+\_\+func.\+h}}
\subsubsection[{\texorpdfstring{T\+V\+M\+\_\+\+D\+L\+L\+\_\+\+E\+X\+P\+O\+R\+T\+\_\+\+P\+A\+C\+K\+E\+D\+\_\+\+F\+U\+NC}{TVM_DLL_EXPORT_PACKED_FUNC}}]{\setlength{\rightskip}{0pt plus 5cm}\#define T\+V\+M\+\_\+\+D\+L\+L\+\_\+\+E\+X\+P\+O\+R\+T\+\_\+\+P\+A\+C\+K\+E\+D\+\_\+\+F\+U\+NC(
\begin{DoxyParamCaption}
\item[{}]{Export\+Name, }
\item[{}]{Function}
\end{DoxyParamCaption}
)}\hypertarget{packed__func_8h_aee75208638f500a4ce5e726c9d87d8ff}{}\label{packed__func_8h_aee75208638f500a4ce5e726c9d87d8ff}
{\bfseries Value\+:}
\begin{DoxyCode}
\textcolor{keyword}{extern} \textcolor{stringliteral}{"C"} \{                                                          \(\backslash\)
  TVM\_DLL \textcolor{keywordtype}{int} ExportName(\hyperlink{unionTVMValue}{TVMValue}* args,                                \(\backslash\)
                         \textcolor{keywordtype}{int}* type\_code,                                \(\backslash\)
                         \textcolor{keywordtype}{int} num\_args,                                  \(\backslash\)
                         \hyperlink{unionTVMValue}{TVMValue}* out\_value,                           \(\backslash\)
                         \textcolor{keywordtype}{int}* out\_type\_code);                           \(\backslash\)
  int ExportName(\hyperlink{unionTVMValue}{TVMValue}* args,                                        \(\backslash\)
                 \textcolor{keywordtype}{int}* type\_code,                                        \(\backslash\)
                 \textcolor{keywordtype}{int} num\_args,                                          \(\backslash\)
                 \hyperlink{unionTVMValue}{TVMValue}* out\_value,                                   \(\backslash\)
                 \textcolor{keywordtype}{int}* out\_type\_code) \{                                  \(\backslash\)
    try \{                                                               \(\backslash\)
      \hyperlink{classtvm_1_1runtime_1_1TVMRetValue}{::tvm::runtime::TVMRetValue} rv;                                   \(\backslash\)
      Function(::\hyperlink{classtvm_1_1runtime_1_1TVMArgs}{tvm::runtime::TVMArgs}(                                 \(\backslash\)
          args, type\_code, num\_args), &rv);                             \(\backslash\)
      rv.MoveToCHost(out\_value, out\_type\_code);                         \(\backslash\)
      return 0;                                                         \(\backslash\)
    \} \textcolor{keywordflow}{catch} (const ::std::runtime\_error& \_except\_) \{                    \hyperlink{c__runtime__api_8h_a477111f9accd70633dc5f2e7139b6cf4}{\(\backslash\)}
\hyperlink{c__runtime__api_8h_a477111f9accd70633dc5f2e7139b6cf4}{      TVMAPISetLastError}(\_except\_.what());                              \(\backslash\)
      return -1;                                                        \(\backslash\)
    \}                                                                   \(\backslash\)
  \}                                                                     \(\backslash\)
  \}
\end{DoxyCode}


Export a function with the Packed\+Func signature as a Packed\+Func that can be loaded by Library\+Module. 


\begin{DoxyParams}{Parameters}
{\em Export\+Name} & The symbol name to be exported. \\
\hline
{\em Function} & The function with Packed\+Func signature. \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
Packed\+Func
\end{DoxySeeAlso}

\begin{DoxyCode}
1 void AddOne\_(TVMArgs args, TVMRetValue* rv) \{
2   int value = args[0];
3   *rv = value + 1;
4 \}
5 // Expose the function as "AddOne"
6 TVM\_DLL\_EXPORT\_PACKED\_FUNC(AddOne, AddOne\_);
\end{DoxyCode}
 \index{packed\+\_\+func.\+h@{packed\+\_\+func.\+h}!T\+V\+M\+\_\+\+D\+L\+L\+\_\+\+E\+X\+P\+O\+R\+T\+\_\+\+T\+Y\+P\+E\+D\+\_\+\+F\+U\+NC@{T\+V\+M\+\_\+\+D\+L\+L\+\_\+\+E\+X\+P\+O\+R\+T\+\_\+\+T\+Y\+P\+E\+D\+\_\+\+F\+U\+NC}}
\index{T\+V\+M\+\_\+\+D\+L\+L\+\_\+\+E\+X\+P\+O\+R\+T\+\_\+\+T\+Y\+P\+E\+D\+\_\+\+F\+U\+NC@{T\+V\+M\+\_\+\+D\+L\+L\+\_\+\+E\+X\+P\+O\+R\+T\+\_\+\+T\+Y\+P\+E\+D\+\_\+\+F\+U\+NC}!packed\+\_\+func.\+h@{packed\+\_\+func.\+h}}
\subsubsection[{\texorpdfstring{T\+V\+M\+\_\+\+D\+L\+L\+\_\+\+E\+X\+P\+O\+R\+T\+\_\+\+T\+Y\+P\+E\+D\+\_\+\+F\+U\+NC}{TVM_DLL_EXPORT_TYPED_FUNC}}]{\setlength{\rightskip}{0pt plus 5cm}\#define T\+V\+M\+\_\+\+D\+L\+L\+\_\+\+E\+X\+P\+O\+R\+T\+\_\+\+T\+Y\+P\+E\+D\+\_\+\+F\+U\+NC(
\begin{DoxyParamCaption}
\item[{}]{Export\+Name, }
\item[{}]{Function}
\end{DoxyParamCaption}
)}\hypertarget{packed__func_8h_ae5b445392a64daa55bef53b4cf53025c}{}\label{packed__func_8h_ae5b445392a64daa55bef53b4cf53025c}
{\bfseries Value\+:}
\begin{DoxyCode}
\textcolor{keyword}{extern} \textcolor{stringliteral}{"C"} \{                                                          \(\backslash\)
  TVM\_DLL \textcolor{keywordtype}{int} ExportName(\hyperlink{unionTVMValue}{TVMValue}* args,                                \(\backslash\)
                         \textcolor{keywordtype}{int}* type\_code,                                \(\backslash\)
                         \textcolor{keywordtype}{int} num\_args,                                  \(\backslash\)
                         \hyperlink{unionTVMValue}{TVMValue}* out\_value,                           \(\backslash\)
                         \textcolor{keywordtype}{int}* out\_type\_code) \{                          \(\backslash\)
    try \{                                                               \(\backslash\)
      auto f = Function;                                                \(\backslash\)
      using FType = ::tvm::runtime::detail::                            \(\backslash\)
                    function\_signature<decltype(f)>::FType;             \(\backslash\)
      \hyperlink{classtvm_1_1runtime_1_1TVMRetValue}{::tvm::runtime::TVMRetValue} rv;                                   \(\backslash\)
      ::tvm::runtime::detail::unpack\_call\_by\_signature<FType>::run(     \(\backslash\)
           f,                                                           \(\backslash\)
           ::\hyperlink{classtvm_1_1runtime_1_1TVMArgs}{tvm::runtime::TVMArgs}(args, type\_code, num\_args), &rv);    \(\backslash\)
      rv.MoveToCHost(out\_value, out\_type\_code);                         \(\backslash\)
      return 0;                                                         \(\backslash\)
    \} \textcolor{keywordflow}{catch} (const ::std::runtime\_error& \_except\_) \{                    \hyperlink{c__runtime__api_8h_a477111f9accd70633dc5f2e7139b6cf4}{\(\backslash\)}
\hyperlink{c__runtime__api_8h_a477111f9accd70633dc5f2e7139b6cf4}{      TVMAPISetLastError}(\_except\_.what());                              \(\backslash\)
      return -1;                                                        \(\backslash\)
    \}                                                                   \(\backslash\)
    \}                                                                   \(\backslash\)
  \}
\end{DoxyCode}


Export typed function as a Packed\+Func that can be loaded by Library\+Module. 


\begin{DoxyParams}{Parameters}
{\em Export\+Name} & The symbol name to be exported. \\
\hline
{\em Function} & The typed function. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
Export\+Name and Function must be different, see code examples below.
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
Typed\+Packed\+Func
\end{DoxySeeAlso}

\begin{DoxyCode}
1 int AddOne\_(int x) \{
2   return x + 1;
3 \}
4 
5 // Expose the function as "AddOne"
6 TVM\_DLL\_EXPORT\_TYPED\_FUNC(AddOne, AddOne\_);
7 
8 // Expose the function as "SubOne"
9 TVM\_DLL\_EXPORT\_TYPED\_FUNC(SubOne, [](int x) \{
10   return x - 1;
11 \});
12 
13 // The following code will cause compilation error.
14 // Because the same Function and ExortName
15 // TVM\_DLL\_EXPORT\_TYPED\_FUNC(AddOne\_, AddOne\_);
16 
17 // The following code is OK, assuming the macro
18 // is in a different namespace from xyz
19 // TVM\_DLL\_EXPORT\_TYPED\_FUNC(AddOne\_, xyz::AddOne\_);
\end{DoxyCode}
 \index{packed\+\_\+func.\+h@{packed\+\_\+func.\+h}!T\+V\+M\+\_\+\+R\+U\+N\+T\+I\+M\+E\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+O\+N\+LY@{T\+V\+M\+\_\+\+R\+U\+N\+T\+I\+M\+E\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+O\+N\+LY}}
\index{T\+V\+M\+\_\+\+R\+U\+N\+T\+I\+M\+E\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+O\+N\+LY@{T\+V\+M\+\_\+\+R\+U\+N\+T\+I\+M\+E\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+O\+N\+LY}!packed\+\_\+func.\+h@{packed\+\_\+func.\+h}}
\subsubsection[{\texorpdfstring{T\+V\+M\+\_\+\+R\+U\+N\+T\+I\+M\+E\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+O\+N\+LY}{TVM_RUNTIME_HEADER_ONLY}}]{\setlength{\rightskip}{0pt plus 5cm}\#define T\+V\+M\+\_\+\+R\+U\+N\+T\+I\+M\+E\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+O\+N\+LY~0}\hypertarget{packed__func_8h_a50e8d21ff57c58c35bc4cc9310e64273}{}\label{packed__func_8h_a50e8d21ff57c58c35bc4cc9310e64273}
